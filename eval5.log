bash: /home/sg2323/miniconda3/envs/faiss/lib/libtinfo.so.6: no version information available (required by bash)
06/10/2024 02:05:35 - WARNING - __main__ - Process rank: 0, device: cuda:0, n_gpu: 1distributed training: True, 16-bits training: False
/home/sg2323/miniconda3/envs/faiss/lib/python3.9/site-packages/datasets/load.py:2547: FutureWarning: 'use_auth_token' was deprecated in favor of 'token' in version 2.14.0 and will be removed in 3.0.0.
You can remove this warning by passing 'token=<use_auth_token>' instead.
  warnings.warn(
/home/sg2323/miniconda3/envs/faiss/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:08<00:08,  8.59s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:11<00:00,  5.10s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:11<00:00,  5.62s/it]
06/10/2024 02:07:23 - INFO - knnlm - Reading /share/rush/datastore/knn-prompt/meta-llama/Llama-2-7b-hf/index_llama_609687689_4096_0_160000000.indexed took 94.98570346832275 s
06/10/2024 02:09:02 - INFO - knnlm - Reading /share/rush/datastore/knn-prompt/meta-llama/Llama-2-7b-hf/index_llama_609687689_4096_160000000_320000000.indexed took 99.39295864105225 s
06/10/2024 02:10:38 - INFO - knnlm - Reading /share/rush/datastore/knn-prompt/meta-llama/Llama-2-7b-hf/index_llama_609687689_4096_320000000_480000000.indexed took 95.56696796417236 s
06/10/2024 02:12:07 - INFO - knnlm - Reading /share/rush/datastore/knn-prompt/meta-llama/Llama-2-7b-hf/index_llama_609687689_4096_480000000_609687689.indexed took 89.0985176563263 s
use knn_gpu
06/10/2024 02:12:34 - INFO - knnlm - Moving index 0 to GPU took 27.249680757522583 s
06/10/2024 02:12:56 - INFO - knnlm - Moving index 1 to GPU took 48.78694438934326 s
06/10/2024 02:13:22 - INFO - knnlm - Moving index 2 to GPU took 74.50123596191406 s
06/10/2024 02:13:49 - INFO - knnlm - Moving index 3 to GPU took 102.25777268409729 s
finish direct map
06/10/2024 02:14:23 - INFO - knnlm - Loading to memory...
/home/sg2323/research/knnlm-limits/knnlm.py:146: UserWarning: The given NumPy array is not writable, and PyTorch does not support non-writable tensors. This means writing to this tensor will result in undefined behavior. You may want to copy the array to protect its data or make it writable before converting it to a tensor. This type of warning will be suppressed for the rest of this program. (Triggered internally at ../torch/csrc/utils/tensor_numpy.cpp:206.)
  self.vals = torch.from_numpy(vals_from_memmap[:]).long().to(self.device)
06/10/2024 02:14:35 - INFO - knnlm - Loading to memory took 12.099347352981567 s
call get_model_last_layer
06/10/2024 02:14:35 - WARNING - accelerate.utils.other - Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
{'premise': 'Dana Reeve, the widow of the actor Christopher Reeve, has died of lung cancer at age 44, according to the Christopher Reeve Foundation.', 'hypothesis': 'Christopher Reeve had an accident.', 'label': 'not_entailment', 'idx': 0}
Not Str
==================================================
MAKE SURE TOKENIZATION AND FORMATTING LOOKS OK

print example 0 of 277:
CONDITIONAL:
<s>  Dana Reeve, the widow of the actor Christopher Reeve, has died of lung cancer at age 44, according to the Christopher Reeve Foundation.
question: Christopher Reeve had an accident. true or false?
answer:
UNCONDITIONAL:
<s> true or false?
answer:
==================================================
word:   true
[1, 29871, 1565]
word:   yes
[1, 29871, 4874]
word:   accurate
[1, 29871, 16232]
word:   correct
[1, 29871, 1959]
word:   faithful
[1, 29871, 27057]
word:   false
[1, 29871, 2089]
word:   no
[1, 29871, 694]
word:   incorrect
[1, 29871, 10240]
word:   wrong
[1, 29871, 2743]
word:   untrue
[1, 29871, 443, 3009]
word:   unfaithful
[1, 29871, 443, 5444, 389, 1319]
/home/sg2323/miniconda3/envs/faiss/lib/python3.9/site-packages/faiss/contrib/torch_utils.py:51: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  x.storage().data_ptr() + x.storage_offset() * 4)
  0%|          | 0/277 [00:00<?, ?it/s]  0%|          | 1/277 [00:00<01:45,  2.61it/s]  1%|          | 2/277 [00:00<01:39,  2.77it/s]  1%|          | 3/277 [00:01<01:42,  2.68it/s]  1%|▏         | 4/277 [00:01<01:35,  2.85it/s]  2%|▏         | 5/277 [00:01<01:29,  3.04it/s]  2%|▏         | 6/277 [00:02<01:26,  3.15it/s]  3%|▎         | 7/277 [00:02<01:28,  3.04it/s]  3%|▎         | 8/277 [00:02<01:25,  3.13it/s]  3%|▎         | 9/277 [00:02<01:24,  3.19it/s]  4%|▎         | 10/277 [00:03<01:21,  3.28it/s]  4%|▍         | 11/277 [00:03<01:20,  3.29it/s]  4%|▍         | 12/277 [00:03<01:18,  3.36it/s]  5%|▍         | 13/277 [00:04<01:19,  3.31it/s]  5%|▌         | 14/277 [00:04<01:19,  3.32it/s]  5%|▌         | 15/277 [00:04<01:19,  3.28it/s]  6%|▌         | 16/277 [00:05<01:16,  3.40it/s]  6%|▌         | 17/277 [00:05<01:15,  3.43it/s]  6%|▋         | 18/277 [00:05<01:16,  3.38it/s]  7%|▋         | 19/277 [00:05<01:16,  3.38it/s]  7%|▋         | 20/277 [00:06<01:16,  3.35it/s]  8%|▊         | 21/277 [00:06<01:17,  3.32it/s]  8%|▊         | 22/277 [00:06<01:17,  3.31it/s]  8%|▊         | 23/277 [00:07<01:16,  3.33it/s]  9%|▊         | 24/277 [00:07<01:17,  3.27it/s]  9%|▉         | 25/277 [00:07<01:16,  3.28it/s]  9%|▉         | 26/277 [00:08<01:16,  3.28it/s] 10%|▉         | 27/277 [00:08<01:16,  3.26it/s] 10%|█         | 28/277 [00:08<01:15,  3.28it/s] 10%|█         | 29/277 [00:08<01:15,  3.30it/s] 11%|█         | 30/277 [00:09<01:11,  3.44it/s] 11%|█         | 31/277 [00:09<01:14,  3.30it/s] 12%|█▏        | 32/277 [00:09<01:13,  3.34it/s] 12%|█▏        | 33/277 [00:10<01:15,  3.22it/s] 12%|█▏        | 34/277 [00:10<01:14,  3.28it/s] 13%|█▎        | 35/277 [00:10<01:13,  3.31it/s] 13%|█▎        | 36/277 [00:11<01:12,  3.34it/s] 13%|█▎        | 37/277 [00:11<01:14,  3.24it/s] 14%|█▎        | 38/277 [00:11<01:13,  3.27it/s] 14%|█▍        | 39/277 [00:12<01:15,  3.17it/s] 14%|█▍        | 40/277 [00:12<01:12,  3.25it/s] 15%|█▍        | 41/277 [00:12<01:12,  3.26it/s] 15%|█▌        | 42/277 [00:12<01:10,  3.35it/s] 16%|█▌        | 43/277 [00:13<01:09,  3.35it/s] 16%|█▌        | 44/277 [00:13<01:08,  3.38it/s] 16%|█▌        | 45/277 [00:13<01:09,  3.33it/s] 17%|█▋        | 46/277 [00:14<01:08,  3.36it/s] 17%|█▋        | 47/277 [00:14<01:08,  3.34it/s] 17%|█▋        | 48/277 [00:14<01:08,  3.35it/s] 18%|█▊        | 49/277 [00:15<01:09,  3.30it/s] 18%|█▊        | 50/277 [00:15<01:08,  3.32it/s] 18%|█▊        | 51/277 [00:15<01:09,  3.24it/s] 19%|█▉        | 52/277 [00:15<01:08,  3.29it/s] 19%|█▉        | 53/277 [00:16<01:09,  3.24it/s] 19%|█▉        | 54/277 [00:16<01:06,  3.37it/s] 20%|█▉        | 55/277 [00:16<01:07,  3.30it/s] 20%|██        | 56/277 [00:17<01:06,  3.34it/s] 21%|██        | 57/277 [00:17<01:07,  3.25it/s] 21%|██        | 58/277 [00:17<01:05,  3.32it/s] 21%|██▏       | 59/277 [00:18<01:06,  3.26it/s] 22%|██▏       | 60/277 [00:18<01:04,  3.34it/s] 22%|██▏       | 61/277 [00:18<01:03,  3.38it/s] 22%|██▏       | 62/277 [00:18<01:04,  3.32it/s] 23%|██▎       | 63/277 [00:19<01:03,  3.37it/s] 23%|██▎       | 64/277 [00:19<01:05,  3.27it/s] 23%|██▎       | 65/277 [00:19<01:03,  3.32it/s] 24%|██▍       | 66/277 [00:20<01:02,  3.39it/s] 24%|██▍       | 67/277 [00:20<01:03,  3.31it/s] 25%|██▍       | 68/277 [00:20<01:02,  3.34it/s] 25%|██▍       | 69/277 [00:21<01:02,  3.32it/s] 25%|██▌       | 70/277 [00:21<01:02,  3.32it/s] 26%|██▌       | 71/277 [00:21<01:02,  3.29it/s] 26%|██▌       | 72/277 [00:21<01:02,  3.26it/s] 26%|██▋       | 73/277 [00:22<01:01,  3.33it/s] 27%|██▋       | 74/277 [00:22<01:02,  3.24it/s] 27%|██▋       | 75/277 [00:22<01:02,  3.22it/s] 27%|██▋       | 76/277 [00:23<01:02,  3.23it/s] 28%|██▊       | 77/277 [00:23<01:01,  3.25it/s] 28%|██▊       | 78/277 [00:23<00:58,  3.39it/s] 29%|██▊       | 79/277 [00:24<00:59,  3.31it/s] 29%|██▉       | 80/277 [00:24<00:58,  3.39it/s] 29%|██▉       | 81/277 [00:24<00:58,  3.36it/s] 30%|██▉       | 82/277 [00:25<00:59,  3.27it/s] 30%|██▉       | 83/277 [00:25<00:59,  3.25it/s] 30%|███       | 84/277 [00:25<00:58,  3.33it/s] 31%|███       | 85/277 [00:25<01:00,  3.20it/s] 31%|███       | 86/277 [00:26<00:59,  3.22it/s] 31%|███▏      | 87/277 [00:26<00:59,  3.21it/s] 32%|███▏      | 88/277 [00:26<00:58,  3.25it/s] 32%|███▏      | 89/277 [00:27<00:57,  3.29it/s] 32%|███▏      | 90/277 [00:27<00:56,  3.33it/s] 33%|███▎      | 91/277 [00:27<00:55,  3.32it/s] 33%|███▎      | 92/277 [00:28<00:54,  3.37it/s] 34%|███▎      | 93/277 [00:28<00:55,  3.31it/s] 34%|███▍      | 94/277 [00:28<00:55,  3.31it/s] 34%|███▍      | 95/277 [00:28<00:54,  3.33it/s] 35%|███▍      | 96/277 [00:29<00:54,  3.31it/s] 35%|███▌      | 97/277 [00:29<00:53,  3.39it/s] 35%|███▌      | 98/277 [00:29<00:54,  3.30it/s] 36%|███▌      | 99/277 [00:30<00:54,  3.27it/s] 36%|███▌      | 100/277 [00:30<00:53,  3.29it/s] 36%|███▋      | 101/277 [00:30<00:54,  3.24it/s] 37%|███▋      | 102/277 [00:31<00:53,  3.28it/s] 37%|███▋      | 103/277 [00:31<00:52,  3.33it/s] 38%|███▊      | 104/277 [00:31<00:51,  3.39it/s] 38%|███▊      | 105/277 [00:31<00:50,  3.42it/s] 38%|███▊      | 106/277 [00:32<00:51,  3.35it/s] 39%|███▊      | 107/277 [00:32<00:51,  3.33it/s] 39%|███▉      | 108/277 [00:32<00:50,  3.34it/s] 39%|███▉      | 109/277 [00:33<00:50,  3.31it/s] 40%|███▉      | 110/277 [00:33<00:50,  3.32it/s] 40%|████      | 111/277 [00:33<00:50,  3.29it/s] 40%|████      | 112/277 [00:34<00:50,  3.28it/s] 41%|████      | 113/277 [00:34<00:48,  3.35it/s] 41%|████      | 114/277 [00:34<00:49,  3.31it/s] 42%|████▏     | 115/277 [00:34<00:48,  3.36it/s] 42%|████▏     | 116/277 [00:35<00:47,  3.36it/s] 42%|████▏     | 117/277 [00:35<00:47,  3.40it/s] 43%|████▎     | 118/277 [00:35<00:46,  3.41it/s] 43%|████▎     | 119/277 [00:36<00:46,  3.38it/s] 43%|████▎     | 120/277 [00:36<00:46,  3.40it/s] 44%|████▎     | 121/277 [00:36<00:46,  3.37it/s] 44%|████▍     | 122/277 [00:37<00:46,  3.37it/s] 44%|████▍     | 123/277 [00:37<00:45,  3.37it/s] 45%|████▍     | 124/277 [00:37<00:46,  3.33it/s] 45%|████▌     | 125/277 [00:37<00:45,  3.36it/s] 45%|████▌     | 126/277 [00:38<00:45,  3.30it/s] 46%|████▌     | 127/277 [00:38<00:45,  3.29it/s] 46%|████▌     | 128/277 [00:38<00:44,  3.37it/s] 47%|████▋     | 129/277 [00:39<00:45,  3.28it/s] 47%|████▋     | 130/277 [00:39<00:45,  3.23it/s] 47%|████▋     | 131/277 [00:39<00:44,  3.31it/s] 48%|████▊     | 132/277 [00:40<00:43,  3.34it/s] 48%|████▊     | 133/277 [00:40<00:42,  3.36it/s] 48%|████▊     | 134/277 [00:40<00:43,  3.31it/s] 49%|████▊     | 135/277 [00:40<00:43,  3.25it/s] 49%|████▉     | 136/277 [00:41<00:42,  3.32it/s] 49%|████▉     | 137/277 [00:41<00:42,  3.29it/s] 50%|████▉     | 138/277 [00:41<00:42,  3.25it/s] 50%|█████     | 139/277 [00:42<00:41,  3.34it/s] 51%|█████     | 140/277 [00:42<00:40,  3.42it/s] 51%|█████     | 141/277 [00:42<00:38,  3.51it/s] 51%|█████▏    | 142/277 [00:43<00:39,  3.44it/s] 52%|█████▏    | 143/277 [00:43<00:38,  3.47it/s] 52%|█████▏    | 144/277 [00:43<00:39,  3.35it/s] 52%|█████▏    | 145/277 [00:43<00:41,  3.20it/s] 53%|█████▎    | 146/277 [00:44<00:40,  3.26it/s] 53%|█████▎    | 147/277 [00:44<00:39,  3.27it/s] 53%|█████▎    | 148/277 [00:44<00:38,  3.32it/s] 54%|█████▍    | 149/277 [00:45<00:38,  3.32it/s] 54%|█████▍    | 150/277 [00:45<00:38,  3.31it/s] 55%|█████▍    | 151/277 [00:45<00:37,  3.35it/s] 55%|█████▍    | 152/277 [00:46<00:37,  3.38it/s] 55%|█████▌    | 153/277 [00:46<00:39,  3.12it/s] 56%|█████▌    | 154/277 [00:46<00:38,  3.24it/s] 56%|█████▌    | 155/277 [00:47<00:37,  3.27it/s] 56%|█████▋    | 156/277 [00:47<00:36,  3.29it/s] 57%|█████▋    | 157/277 [00:47<00:35,  3.34it/s] 57%|█████▋    | 158/277 [00:47<00:35,  3.34it/s] 57%|█████▋    | 159/277 [00:48<00:35,  3.31it/s] 58%|█████▊    | 160/277 [00:48<00:35,  3.33it/s] 58%|█████▊    | 161/277 [00:48<00:35,  3.31it/s] 58%|█████▊    | 162/277 [00:49<00:34,  3.31it/s] 59%|█████▉    | 163/277 [00:49<00:37,  3.05it/s] 59%|█████▉    | 164/277 [00:49<00:35,  3.16it/s] 60%|█████▉    | 165/277 [00:50<00:34,  3.29it/s] 60%|█████▉    | 166/277 [00:50<00:33,  3.36it/s] 60%|██████    | 167/277 [00:50<00:32,  3.38it/s] 61%|██████    | 168/277 [00:50<00:32,  3.39it/s] 61%|██████    | 169/277 [00:51<00:31,  3.39it/s] 61%|██████▏   | 170/277 [00:51<00:31,  3.39it/s] 62%|██████▏   | 171/277 [00:51<00:31,  3.37it/s] 62%|██████▏   | 172/277 [00:52<00:31,  3.36it/s] 62%|██████▏   | 173/277 [00:52<00:31,  3.33it/s] 63%|██████▎   | 174/277 [00:52<00:31,  3.31it/s] 63%|██████▎   | 175/277 [00:53<00:32,  3.15it/s] 64%|██████▎   | 176/277 [00:53<00:31,  3.24it/s] 64%|██████▍   | 177/277 [00:53<00:30,  3.30it/s] 64%|██████▍   | 178/277 [00:53<00:29,  3.32it/s] 65%|██████▍   | 179/277 [00:54<00:28,  3.41it/s] 65%|██████▍   | 180/277 [00:54<00:28,  3.43it/s] 65%|██████▌   | 181/277 [00:54<00:28,  3.35it/s] 66%|██████▌   | 182/277 [00:55<00:27,  3.40it/s] 66%|██████▌   | 183/277 [00:55<00:28,  3.32it/s] 66%|██████▋   | 184/277 [00:55<00:30,  3.02it/s] 67%|██████▋   | 185/277 [00:56<00:29,  3.14it/s] 67%|██████▋   | 186/277 [00:56<00:28,  3.24it/s] 68%|██████▊   | 187/277 [00:56<00:27,  3.28it/s] 68%|██████▊   | 188/277 [00:56<00:26,  3.32it/s] 68%|██████▊   | 189/277 [00:57<00:26,  3.33it/s] 69%|██████▊   | 190/277 [00:57<00:26,  3.34it/s] 69%|██████▉   | 191/277 [00:57<00:25,  3.40it/s] 69%|██████▉   | 192/277 [00:58<00:24,  3.46it/s] 70%|██████▉   | 193/277 [00:58<00:23,  3.52it/s] 70%|███████   | 194/277 [00:58<00:26,  3.14it/s] 70%|███████   | 195/277 [00:59<00:26,  3.14it/s] 71%|███████   | 196/277 [00:59<00:25,  3.22it/s] 71%|███████   | 197/277 [00:59<00:24,  3.22it/s] 71%|███████▏  | 198/277 [01:00<00:24,  3.25it/s] 72%|███████▏  | 199/277 [01:00<00:23,  3.30it/s] 72%|███████▏  | 200/277 [01:00<00:22,  3.38it/s] 73%|███████▎  | 201/277 [01:00<00:22,  3.41it/s] 73%|███████▎  | 202/277 [01:01<00:21,  3.44it/s] 73%|███████▎  | 203/277 [01:01<00:21,  3.40it/s] 74%|███████▎  | 204/277 [01:01<00:21,  3.47it/s] 74%|███████▍  | 205/277 [01:02<00:20,  3.47it/s] 74%|███████▍  | 206/277 [01:02<00:23,  3.07it/s] 75%|███████▍  | 207/277 [01:02<00:22,  3.18it/s] 75%|███████▌  | 208/277 [01:03<00:21,  3.22it/s] 75%|███████▌  | 209/277 [01:03<00:20,  3.25it/s] 76%|███████▌  | 210/277 [01:03<00:20,  3.29it/s] 76%|███████▌  | 211/277 [01:03<00:19,  3.31it/s] 77%|███████▋  | 212/277 [01:04<00:19,  3.40it/s] 77%|███████▋  | 213/277 [01:04<00:18,  3.42it/s] 77%|███████▋  | 214/277 [01:04<00:18,  3.38it/s] 78%|███████▊  | 215/277 [01:05<00:18,  3.39it/s] 78%|███████▊  | 216/277 [01:05<00:17,  3.43it/s] 78%|███████▊  | 217/277 [01:05<00:19,  3.06it/s] 79%|███████▊  | 218/277 [01:06<00:18,  3.16it/s] 79%|███████▉  | 219/277 [01:06<00:17,  3.27it/s] 79%|███████▉  | 220/277 [01:06<00:17,  3.33it/s] 80%|███████▉  | 221/277 [01:06<00:16,  3.35it/s] 80%|████████  | 222/277 [01:07<00:16,  3.31it/s] 81%|████████  | 223/277 [01:07<00:15,  3.43it/s] 81%|████████  | 224/277 [01:07<00:15,  3.44it/s] 81%|████████  | 225/277 [01:08<00:15,  3.40it/s] 82%|████████▏ | 226/277 [01:08<00:14,  3.41it/s] 82%|████████▏ | 227/277 [01:08<00:14,  3.41it/s] 82%|████████▏ | 228/277 [01:09<00:14,  3.42it/s] 83%|████████▎ | 229/277 [01:09<00:15,  3.07it/s] 83%|████████▎ | 230/277 [01:09<00:14,  3.16it/s] 83%|████████▎ | 231/277 [01:09<00:14,  3.22it/s] 84%|████████▍ | 232/277 [01:10<00:13,  3.29it/s] 84%|████████▍ | 233/277 [01:10<00:13,  3.33it/s] 84%|████████▍ | 234/277 [01:10<00:12,  3.40it/s] 85%|████████▍ | 235/277 [01:11<00:12,  3.45it/s] 85%|████████▌ | 236/277 [01:11<00:11,  3.49it/s] 86%|████████▌ | 237/277 [01:11<00:11,  3.47it/s] 86%|████████▌ | 238/277 [01:11<00:11,  3.50it/s] 86%|████████▋ | 239/277 [01:12<00:10,  3.48it/s] 87%|████████▋ | 240/277 [01:12<00:11,  3.16it/s] 87%|████████▋ | 241/277 [01:12<00:11,  3.22it/s] 87%|████████▋ | 242/277 [01:13<00:10,  3.27it/s] 88%|████████▊ | 243/277 [01:13<00:10,  3.33it/s] 88%|████████▊ | 244/277 [01:13<00:09,  3.36it/s] 88%|████████▊ | 245/277 [01:14<00:09,  3.29it/s] 89%|████████▉ | 246/277 [01:14<00:09,  3.33it/s] 89%|████████▉ | 247/277 [01:14<00:08,  3.41it/s] 90%|████████▉ | 248/277 [01:14<00:08,  3.49it/s] 90%|████████▉ | 249/277 [01:15<00:07,  3.51it/s] 90%|█████████ | 250/277 [01:15<00:07,  3.55it/s] 91%|█████████ | 251/277 [01:15<00:07,  3.55it/s] 91%|█████████ | 252/277 [01:16<00:07,  3.42it/s] 91%|█████████▏| 253/277 [01:16<00:07,  3.42it/s] 92%|█████████▏| 254/277 [01:16<00:06,  3.33it/s] 92%|█████████▏| 255/277 [01:17<00:06,  3.43it/s] 92%|█████████▏| 256/277 [01:17<00:06,  3.35it/s] 93%|█████████▎| 257/277 [01:17<00:05,  3.35it/s] 93%|█████████▎| 258/277 [01:17<00:05,  3.30it/s] 94%|█████████▎| 259/277 [01:18<00:05,  3.40it/s] 94%|█████████▍| 260/277 [01:18<00:05,  3.38it/s] 94%|█████████▍| 261/277 [01:18<00:04,  3.45it/s] 95%|█████████▍| 262/277 [01:19<00:04,  3.43it/s] 95%|█████████▍| 263/277 [01:19<00:04,  3.37it/s] 95%|█████████▌| 264/277 [01:19<00:03,  3.38it/s] 96%|█████████▌| 265/277 [01:19<00:03,  3.39it/s] 96%|█████████▌| 266/277 [01:20<00:03,  3.28it/s] 96%|█████████▋| 267/277 [01:20<00:02,  3.35it/s] 97%|█████████▋| 268/277 [01:20<00:02,  3.29it/s] 97%|█████████▋| 269/277 [01:21<00:02,  3.28it/s] 97%|█████████▋| 270/277 [01:21<00:02,  3.25it/s] 98%|█████████▊| 271/277 [01:21<00:01,  3.26it/s] 98%|█████████▊| 272/277 [01:22<00:01,  3.34it/s] 99%|█████████▊| 273/277 [01:22<00:01,  3.30it/s] 99%|█████████▉| 274/277 [01:22<00:00,  3.36it/s] 99%|█████████▉| 275/277 [01:23<00:00,  3.31it/s]100%|█████████▉| 276/277 [01:23<00:00,  3.33it/s]100%|██████████| 277/277 [01:23<00:00,  3.36it/s]100%|██████████| 277/277 [01:23<00:00,  3.31it/s]
('meta-llama/Llama-2-7b-hf',) gets {'lm': 0.4729241877256318, 'dcpmi': 0.516245487364621, 'pmi': 0.5776173285198556}% on None
0.4729241877256318 & 0.5776173285198556 & 0.516245487364621
parameters
k 2048
lmbda 0.1
temp 5.0
06/10/2024 02:17:45 - WARNING - __main__ - Process rank: 0, device: cuda:0, n_gpu: 1distributed training: True, 16-bits training: False
/home/sg2323/miniconda3/envs/faiss/lib/python3.9/site-packages/datasets/load.py:2547: FutureWarning: 'use_auth_token' was deprecated in favor of 'token' in version 2.14.0 and will be removed in 3.0.0.
You can remove this warning by passing 'token=<use_auth_token>' instead.
  warnings.warn(
/home/sg2323/miniconda3/envs/faiss/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:09<00:09,  9.93s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:13<00:00,  6.43s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:13<00:00,  6.96s/it]
06/10/2024 02:20:36 - INFO - knnlm - Reading /share/rush/datastore/knn-prompt/meta-llama/Llama-2-7b-hf/index_llama_609687689_4096_0_160000000.indexed took 154.29379439353943 s
06/10/2024 02:22:55 - INFO - knnlm - Reading /share/rush/datastore/knn-prompt/meta-llama/Llama-2-7b-hf/index_llama_609687689_4096_160000000_320000000.indexed took 138.8019621372223 s
06/10/2024 02:25:00 - INFO - knnlm - Reading /share/rush/datastore/knn-prompt/meta-llama/Llama-2-7b-hf/index_llama_609687689_4096_320000000_480000000.indexed took 125.87347054481506 s
06/10/2024 02:26:26 - INFO - knnlm - Reading /share/rush/datastore/knn-prompt/meta-llama/Llama-2-7b-hf/index_llama_609687689_4096_480000000_609687689.indexed took 86.07712602615356 s
use knn_gpu
06/10/2024 02:27:05 - INFO - knnlm - Moving index 0 to GPU took 38.33796000480652 s
06/10/2024 02:27:35 - INFO - knnlm - Moving index 1 to GPU took 68.68708968162537 s
06/10/2024 02:28:07 - INFO - knnlm - Moving index 2 to GPU took 100.83928966522217 s
06/10/2024 02:28:35 - INFO - knnlm - Moving index 3 to GPU took 128.89338326454163 s
finish direct map
06/10/2024 02:29:07 - INFO - knnlm - Loading to memory...
/home/sg2323/research/knnlm-limits/knnlm.py:146: UserWarning: The given NumPy array is not writable, and PyTorch does not support non-writable tensors. This means writing to this tensor will result in undefined behavior. You may want to copy the array to protect its data or make it writable before converting it to a tensor. This type of warning will be suppressed for the rest of this program. (Triggered internally at ../torch/csrc/utils/tensor_numpy.cpp:206.)
  self.vals = torch.from_numpy(vals_from_memmap[:]).long().to(self.device)
06/10/2024 02:29:19 - INFO - knnlm - Loading to memory took 12.902032136917114 s
call get_model_last_layer
06/10/2024 02:29:19 - WARNING - accelerate.utils.other - Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
{'task': 'rotten_tomatoes', 'input': 'compassionately explores the seemingly irreconcilable situation between conservative christian parents and their estranged gay and lesbian children .', 'output': 'positive', 'options': ['negative', 'positive']}
Not Str
==================================================
MAKE SURE TOKENIZATION AND FORMATTING LOOKS OK

print example 0 of 1066:
CONDITIONAL:
<s> compassionately explores the seemingly irreconcilable situation between conservative christian parents and their estranged gay and lesbian children . The sentence has a tone that is
UNCONDITIONAL:
<s> The sentence has a tone that is
==================================================
word:   awful
[1, 29871, 28893]
word:   bad
[1, 29871, 4319]
word:   terrible
[1, 29871, 16403]
word:   negative
[1, 29871, 8178]
word:   nice
[1, 29871, 7575]
word:   great
[1, 29871, 2107]
word:   positive
[1, 29871, 6374]
word:   good
[1, 29871, 1781]
/home/sg2323/miniconda3/envs/faiss/lib/python3.9/site-packages/faiss/contrib/torch_utils.py:51: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  x.storage().data_ptr() + x.storage_offset() * 4)
  0%|          | 0/1066 [00:00<?, ?it/s]  0%|          | 1/1066 [00:00<07:26,  2.39it/s]  0%|          | 2/1066 [00:00<05:51,  3.02it/s]  0%|          | 3/1066 [00:00<05:20,  3.32it/s]  0%|          | 4/1066 [00:01<05:22,  3.29it/s]  0%|          | 5/1066 [00:01<05:04,  3.49it/s]  1%|          | 6/1066 [00:01<04:58,  3.56it/s]  1%|          | 7/1066 [00:02<05:05,  3.46it/s]  1%|          | 8/1066 [00:02<04:58,  3.54it/s]  1%|          | 9/1066 [00:02<05:04,  3.47it/s]  1%|          | 10/1066 [00:02<05:05,  3.46it/s]  1%|          | 11/1066 [00:03<05:01,  3.50it/s]  1%|          | 12/1066 [00:03<05:09,  3.41it/s]  1%|          | 13/1066 [00:03<05:06,  3.43it/s]  1%|▏         | 14/1066 [00:04<05:03,  3.47it/s]  1%|▏         | 15/1066 [00:04<05:09,  3.40it/s]  2%|▏         | 16/1066 [00:04<05:01,  3.49it/s]  2%|▏         | 17/1066 [00:04<04:52,  3.58it/s]  2%|▏         | 18/1066 [00:05<04:55,  3.55it/s]  2%|▏         | 19/1066 [00:05<04:54,  3.55it/s]  2%|▏         | 20/1066 [00:05<04:58,  3.51it/s]  2%|▏         | 21/1066 [00:06<05:00,  3.48it/s]  2%|▏         | 22/1066 [00:06<04:54,  3.55it/s]  2%|▏         | 23/1066 [00:06<04:49,  3.61it/s]  2%|▏         | 24/1066 [00:06<04:44,  3.66it/s]  2%|▏         | 25/1066 [00:07<04:49,  3.60it/s]  2%|▏         | 26/1066 [00:07<04:45,  3.64it/s]  3%|▎         | 27/1066 [00:07<04:45,  3.63it/s]  3%|▎         | 28/1066 [00:08<04:55,  3.52it/s]  3%|▎         | 29/1066 [00:08<04:50,  3.57it/s]  3%|▎         | 30/1066 [00:08<04:42,  3.66it/s]  3%|▎         | 31/1066 [00:08<04:53,  3.53it/s]  3%|▎         | 32/1066 [00:09<04:46,  3.61it/s]  3%|▎         | 33/1066 [00:09<04:42,  3.65it/s]  3%|▎         | 34/1066 [00:09<04:42,  3.65it/s]  3%|▎         | 35/1066 [00:09<04:47,  3.58it/s]  3%|▎         | 36/1066 [00:10<04:48,  3.57it/s]  3%|▎         | 37/1066 [00:10<04:41,  3.66it/s]  4%|▎         | 38/1066 [00:10<04:49,  3.56it/s]  4%|▎         | 39/1066 [00:11<04:45,  3.60it/s]  4%|▍         | 40/1066 [00:11<04:43,  3.62it/s]  4%|▍         | 41/1066 [00:11<04:47,  3.56it/s]  4%|▍         | 42/1066 [00:11<04:37,  3.69it/s]  4%|▍         | 43/1066 [00:12<04:36,  3.70it/s]  4%|▍         | 44/1066 [00:12<04:36,  3.70it/s]  4%|▍         | 45/1066 [00:12<04:46,  3.56it/s]  4%|▍         | 46/1066 [00:13<04:45,  3.57it/s]  4%|▍         | 47/1066 [00:13<04:41,  3.62it/s]  5%|▍         | 48/1066 [00:13<04:46,  3.55it/s]  5%|▍         | 49/1066 [00:13<04:42,  3.60it/s]  5%|▍         | 50/1066 [00:14<04:35,  3.69it/s]  5%|▍         | 51/1066 [00:14<04:34,  3.70it/s]  5%|▍         | 52/1066 [00:14<04:29,  3.77it/s]  5%|▍         | 53/1066 [00:14<04:33,  3.70it/s]  5%|▌         | 54/1066 [00:15<04:31,  3.73it/s]  5%|▌         | 55/1066 [00:15<04:26,  3.79it/s]  5%|▌         | 56/1066 [00:15<04:34,  3.68it/s]  5%|▌         | 57/1066 [00:16<04:41,  3.58it/s]  5%|▌         | 58/1066 [00:16<04:44,  3.54it/s]  6%|▌         | 59/1066 [00:16<04:45,  3.52it/s]  6%|▌         | 60/1066 [00:16<04:40,  3.58it/s]  6%|▌         | 61/1066 [00:17<04:47,  3.50it/s]  6%|▌         | 62/1066 [00:17<04:44,  3.53it/s]  6%|▌         | 63/1066 [00:17<04:34,  3.65it/s]  6%|▌         | 64/1066 [00:17<04:40,  3.57it/s]  6%|▌         | 65/1066 [00:18<04:38,  3.60it/s]  6%|▌         | 66/1066 [00:18<04:41,  3.55it/s]  6%|▋         | 67/1066 [00:18<04:35,  3.63it/s]  6%|▋         | 68/1066 [00:19<04:34,  3.63it/s]  6%|▋         | 69/1066 [00:19<04:40,  3.56it/s]  7%|▋         | 70/1066 [00:19<04:37,  3.59it/s]  7%|▋         | 71/1066 [00:19<04:34,  3.62it/s]  7%|▋         | 72/1066 [00:20<04:42,  3.52it/s]  7%|▋         | 73/1066 [00:20<04:41,  3.53it/s]  7%|▋         | 74/1066 [00:20<04:34,  3.61it/s]  7%|▋         | 75/1066 [00:21<04:39,  3.54it/s]  7%|▋         | 76/1066 [00:21<04:39,  3.54it/s]  7%|▋         | 77/1066 [00:21<04:42,  3.50it/s]  7%|▋         | 78/1066 [00:21<04:40,  3.52it/s]  7%|▋         | 79/1066 [00:22<04:31,  3.64it/s]  8%|▊         | 80/1066 [00:22<04:36,  3.57it/s]  8%|▊         | 81/1066 [00:22<04:35,  3.57it/s]  8%|▊         | 82/1066 [00:23<04:32,  3.61it/s]  8%|▊         | 83/1066 [00:23<04:38,  3.53it/s]  8%|▊         | 84/1066 [00:23<04:33,  3.59it/s]  8%|▊         | 85/1066 [00:23<04:36,  3.55it/s]  8%|▊         | 86/1066 [00:24<04:33,  3.59it/s]  8%|▊         | 87/1066 [00:24<04:27,  3.66it/s]  8%|▊         | 88/1066 [00:24<04:32,  3.58it/s]  8%|▊         | 89/1066 [00:24<04:32,  3.59it/s]  8%|▊         | 90/1066 [00:25<04:28,  3.63it/s]  9%|▊         | 91/1066 [00:25<04:33,  3.57it/s]  9%|▊         | 92/1066 [00:25<04:31,  3.59it/s]  9%|▊         | 93/1066 [00:26<04:28,  3.62it/s]  9%|▉         | 94/1066 [00:26<04:30,  3.59it/s]  9%|▉         | 95/1066 [00:26<04:27,  3.63it/s]  9%|▉         | 96/1066 [00:26<04:30,  3.58it/s]  9%|▉         | 97/1066 [00:27<04:33,  3.54it/s]  9%|▉         | 98/1066 [00:27<04:34,  3.53it/s]  9%|▉         | 99/1066 [00:27<04:36,  3.50it/s]  9%|▉         | 100/1066 [00:28<04:37,  3.47it/s]  9%|▉         | 101/1066 [00:28<04:32,  3.54it/s] 10%|▉         | 102/1066 [00:28<04:36,  3.48it/s] 10%|▉         | 103/1066 [00:28<04:29,  3.57it/s] 10%|▉         | 104/1066 [00:29<04:33,  3.51it/s] 10%|▉         | 105/1066 [00:29<04:29,  3.56it/s] 10%|▉         | 106/1066 [00:29<04:23,  3.64it/s] 10%|█         | 107/1066 [00:30<04:26,  3.60it/s] 10%|█         | 108/1066 [00:30<04:24,  3.62it/s] 10%|█         | 109/1066 [00:30<04:21,  3.66it/s] 10%|█         | 110/1066 [00:30<04:24,  3.61it/s] 10%|█         | 111/1066 [00:31<04:23,  3.62it/s] 11%|█         | 112/1066 [00:31<04:26,  3.59it/s] 11%|█         | 113/1066 [00:31<04:24,  3.61it/s] 11%|█         | 114/1066 [00:31<04:19,  3.66it/s] 11%|█         | 115/1066 [00:32<04:26,  3.57it/s] 11%|█         | 116/1066 [00:32<04:23,  3.61it/s] 11%|█         | 117/1066 [00:32<04:24,  3.59it/s] 11%|█         | 118/1066 [00:33<04:28,  3.53it/s] 11%|█         | 119/1066 [00:33<04:24,  3.58it/s] 11%|█▏        | 120/1066 [00:33<04:17,  3.68it/s] 11%|█▏        | 121/1066 [00:33<04:25,  3.55it/s] 11%|█▏        | 122/1066 [00:34<04:23,  3.59it/s] 12%|█▏        | 123/1066 [00:34<04:18,  3.65it/s] 12%|█▏        | 124/1066 [00:34<04:23,  3.58it/s] 12%|█▏        | 125/1066 [00:35<04:18,  3.63it/s] 12%|█▏        | 126/1066 [00:35<04:21,  3.59it/s] 12%|█▏        | 127/1066 [00:35<04:19,  3.61it/s] 12%|█▏        | 128/1066 [00:35<04:14,  3.69it/s] 12%|█▏        | 129/1066 [00:36<04:21,  3.58it/s] 12%|█▏        | 130/1066 [00:36<04:20,  3.60it/s] 12%|█▏        | 131/1066 [00:36<04:18,  3.62it/s] 12%|█▏        | 132/1066 [00:36<04:20,  3.59it/s] 12%|█▏        | 133/1066 [00:37<04:17,  3.62it/s] 13%|█▎        | 134/1066 [00:37<04:15,  3.65it/s] 13%|█▎        | 135/1066 [00:37<04:23,  3.53it/s] 13%|█▎        | 136/1066 [00:38<04:15,  3.64it/s] 13%|█▎        | 137/1066 [00:38<04:14,  3.65it/s] 13%|█▎        | 138/1066 [00:38<04:17,  3.61it/s] 13%|█▎        | 139/1066 [00:38<04:17,  3.60it/s] 13%|█▎        | 140/1066 [00:39<04:16,  3.61it/s] 13%|█▎        | 141/1066 [00:39<04:14,  3.63it/s] 13%|█▎        | 142/1066 [00:39<04:11,  3.68it/s] 13%|█▎        | 143/1066 [00:39<04:16,  3.60it/s] 14%|█▎        | 144/1066 [00:40<04:12,  3.66it/s] 14%|█▎        | 145/1066 [00:40<04:17,  3.58it/s] 14%|█▎        | 146/1066 [00:40<04:11,  3.66it/s] 14%|█▍        | 147/1066 [00:41<04:09,  3.69it/s] 14%|█▍        | 148/1066 [00:41<04:12,  3.64it/s] 14%|█▍        | 149/1066 [00:41<04:06,  3.71it/s] 14%|█▍        | 150/1066 [00:41<04:01,  3.79it/s] 14%|█▍        | 151/1066 [00:42<04:09,  3.67it/s] 14%|█▍        | 152/1066 [00:42<04:03,  3.75it/s] 14%|█▍        | 153/1066 [00:42<04:00,  3.80it/s] 14%|█▍        | 154/1066 [00:42<04:07,  3.69it/s] 15%|█▍        | 155/1066 [00:43<04:05,  3.72it/s] 15%|█▍        | 156/1066 [00:43<04:14,  3.58it/s] 15%|█▍        | 157/1066 [00:43<04:09,  3.64it/s] 15%|█▍        | 158/1066 [00:44<04:12,  3.59it/s] 15%|█▍        | 159/1066 [00:44<04:04,  3.71it/s] 15%|█▌        | 160/1066 [00:44<04:01,  3.75it/s] 15%|█▌        | 161/1066 [00:44<04:01,  3.75it/s] 15%|█▌        | 162/1066 [00:45<03:58,  3.79it/s] 15%|█▌        | 163/1066 [00:45<04:03,  3.71it/s] 15%|█▌        | 164/1066 [00:45<04:08,  3.63it/s] 15%|█▌        | 165/1066 [00:45<04:04,  3.68it/s] 16%|█▌        | 166/1066 [00:46<04:00,  3.74it/s] 16%|█▌        | 167/1066 [00:46<04:04,  3.68it/s] 16%|█▌        | 168/1066 [00:46<04:02,  3.71it/s] 16%|█▌        | 169/1066 [00:47<04:01,  3.71it/s] 16%|█▌        | 170/1066 [00:47<04:05,  3.65it/s] 16%|█▌        | 171/1066 [00:47<04:01,  3.71it/s] 16%|█▌        | 172/1066 [00:47<04:03,  3.67it/s] 16%|█▌        | 173/1066 [00:48<03:58,  3.75it/s] 16%|█▋        | 174/1066 [00:48<03:56,  3.77it/s] 16%|█▋        | 175/1066 [00:48<04:03,  3.66it/s] 17%|█▋        | 176/1066 [00:48<03:58,  3.74it/s] 17%|█▋        | 177/1066 [00:49<04:05,  3.62it/s] 17%|█▋        | 178/1066 [00:49<03:59,  3.72it/s] 17%|█▋        | 179/1066 [00:49<03:59,  3.71it/s] 17%|█▋        | 180/1066 [00:50<04:06,  3.59it/s] 17%|█▋        | 181/1066 [00:50<04:03,  3.63it/s] 17%|█▋        | 182/1066 [00:50<04:09,  3.55it/s] 17%|█▋        | 183/1066 [00:50<04:02,  3.64it/s] 17%|█▋        | 184/1066 [00:51<03:59,  3.69it/s] 17%|█▋        | 185/1066 [00:51<04:04,  3.60it/s] 17%|█▋        | 186/1066 [00:51<04:03,  3.61it/s] 18%|█▊        | 187/1066 [00:51<03:59,  3.67it/s] 18%|█▊        | 188/1066 [00:52<04:00,  3.65it/s] 18%|█▊        | 189/1066 [00:52<04:01,  3.63it/s] 18%|█▊        | 190/1066 [00:52<04:10,  3.50it/s] 18%|█▊        | 191/1066 [00:53<04:04,  3.58it/s] 18%|█▊        | 192/1066 [00:53<03:55,  3.71it/s] 18%|█▊        | 193/1066 [00:53<04:01,  3.61it/s] 18%|█▊        | 194/1066 [00:53<04:02,  3.59it/s] 18%|█▊        | 195/1066 [00:54<04:03,  3.58it/s] 18%|█▊        | 196/1066 [00:54<03:57,  3.66it/s] 18%|█▊        | 197/1066 [00:54<04:00,  3.61it/s] 19%|█▊        | 198/1066 [00:54<03:59,  3.63it/s] 19%|█▊        | 199/1066 [00:55<04:01,  3.59it/s] 19%|█▉        | 200/1066 [00:55<03:57,  3.65it/s] 19%|█▉        | 201/1066 [00:55<03:54,  3.69it/s] 19%|█▉        | 202/1066 [00:56<03:59,  3.61it/s] 19%|█▉        | 203/1066 [00:56<04:00,  3.59it/s] 19%|█▉        | 204/1066 [00:56<04:03,  3.54it/s] 19%|█▉        | 205/1066 [00:56<04:01,  3.57it/s] 19%|█▉        | 206/1066 [00:57<04:05,  3.51it/s] 19%|█▉        | 207/1066 [00:57<04:01,  3.56it/s] 20%|█▉        | 208/1066 [00:57<03:59,  3.58it/s] 20%|█▉        | 209/1066 [00:58<04:01,  3.55it/s] 20%|█▉        | 210/1066 [00:58<04:02,  3.53it/s] 20%|█▉        | 211/1066 [00:58<04:05,  3.48it/s] 20%|█▉        | 212/1066 [00:58<04:02,  3.52it/s] 20%|█▉        | 213/1066 [00:59<04:00,  3.55it/s] 20%|██        | 214/1066 [00:59<03:57,  3.58it/s] 20%|██        | 215/1066 [00:59<03:59,  3.56it/s] 20%|██        | 216/1066 [01:00<04:01,  3.52it/s] 20%|██        | 217/1066 [01:00<03:58,  3.56it/s] 20%|██        | 218/1066 [01:00<04:00,  3.52it/s] 21%|██        | 219/1066 [01:00<03:50,  3.68it/s] 21%|██        | 220/1066 [01:01<03:54,  3.61it/s] 21%|██        | 221/1066 [01:01<03:55,  3.59it/s] 21%|██        | 222/1066 [01:01<04:02,  3.48it/s] 21%|██        | 223/1066 [01:02<03:56,  3.57it/s] 21%|██        | 224/1066 [01:02<03:52,  3.63it/s] 21%|██        | 225/1066 [01:02<03:54,  3.59it/s] 21%|██        | 226/1066 [01:02<03:51,  3.62it/s] 21%|██▏       | 227/1066 [01:03<03:52,  3.61it/s] 21%|██▏       | 228/1066 [01:03<03:55,  3.56it/s] 21%|██▏       | 229/1066 [01:03<03:49,  3.64it/s] 22%|██▏       | 230/1066 [01:03<03:55,  3.55it/s] 22%|██▏       | 231/1066 [01:04<03:53,  3.57it/s] 22%|██▏       | 232/1066 [01:04<03:54,  3.55it/s] 22%|██▏       | 233/1066 [01:04<03:51,  3.60it/s] 22%|██▏       | 234/1066 [01:05<03:47,  3.66it/s] 22%|██▏       | 235/1066 [01:05<03:52,  3.57it/s] 22%|██▏       | 236/1066 [01:05<03:50,  3.60it/s] 22%|██▏       | 237/1066 [01:05<03:53,  3.56it/s] 22%|██▏       | 238/1066 [01:06<03:48,  3.62it/s] 22%|██▏       | 239/1066 [01:06<03:51,  3.58it/s] 23%|██▎       | 240/1066 [01:06<03:51,  3.57it/s] 23%|██▎       | 241/1066 [01:07<03:49,  3.60it/s] 23%|██▎       | 242/1066 [01:07<03:52,  3.55it/s] 23%|██▎       | 243/1066 [01:07<03:47,  3.61it/s] 23%|██▎       | 244/1066 [01:07<03:50,  3.56it/s] 23%|██▎       | 245/1066 [01:08<03:47,  3.61it/s] 23%|██▎       | 246/1066 [01:08<03:50,  3.56it/s] 23%|██▎       | 247/1066 [01:08<03:50,  3.55it/s] 23%|██▎       | 248/1066 [01:08<03:43,  3.66it/s] 23%|██▎       | 249/1066 [01:09<04:05,  3.33it/s] 23%|██▎       | 250/1066 [01:09<03:57,  3.44it/s] 24%|██▎       | 251/1066 [01:09<03:51,  3.51it/s] 24%|██▎       | 252/1066 [01:10<03:47,  3.58it/s] 24%|██▎       | 253/1066 [01:10<03:46,  3.60it/s] 24%|██▍       | 254/1066 [01:10<03:47,  3.57it/s] 24%|██▍       | 255/1066 [01:10<03:48,  3.55it/s] 24%|██▍       | 256/1066 [01:11<03:45,  3.59it/s] 24%|██▍       | 257/1066 [01:11<03:41,  3.66it/s] 24%|██▍       | 258/1066 [01:11<03:39,  3.68it/s] 24%|██▍       | 259/1066 [01:12<03:41,  3.65it/s] 24%|██▍       | 260/1066 [01:12<04:02,  3.33it/s] 24%|██▍       | 261/1066 [01:12<03:55,  3.42it/s] 25%|██▍       | 262/1066 [01:12<03:50,  3.49it/s] 25%|██▍       | 263/1066 [01:13<03:44,  3.58it/s] 25%|██▍       | 264/1066 [01:13<03:42,  3.61it/s] 25%|██▍       | 265/1066 [01:13<03:37,  3.68it/s] 25%|██▍       | 266/1066 [01:14<03:33,  3.74it/s] 25%|██▌       | 267/1066 [01:14<03:35,  3.71it/s] 25%|██▌       | 268/1066 [01:14<03:40,  3.62it/s] 25%|██▌       | 269/1066 [01:14<03:43,  3.57it/s] 25%|██▌       | 270/1066 [01:15<03:39,  3.63it/s] 25%|██▌       | 271/1066 [01:15<04:04,  3.25it/s] 26%|██▌       | 272/1066 [01:15<03:59,  3.31it/s] 26%|██▌       | 273/1066 [01:16<03:54,  3.38it/s] 26%|██▌       | 274/1066 [01:16<03:44,  3.52it/s] 26%|██▌       | 275/1066 [01:16<03:43,  3.55it/s] 26%|██▌       | 276/1066 [01:16<03:37,  3.64it/s] 26%|██▌       | 277/1066 [01:17<03:34,  3.67it/s] 26%|██▌       | 278/1066 [01:17<03:29,  3.76it/s] 26%|██▌       | 279/1066 [01:17<03:28,  3.78it/s] 26%|██▋       | 280/1066 [01:17<03:32,  3.70it/s] 26%|██▋       | 281/1066 [01:18<03:36,  3.62it/s] 26%|██▋       | 282/1066 [01:18<03:38,  3.59it/s] 27%|██▋       | 283/1066 [01:18<03:42,  3.52it/s] 27%|██▋       | 284/1066 [01:19<03:39,  3.56it/s] 27%|██▋       | 285/1066 [01:19<03:49,  3.40it/s] 27%|██▋       | 286/1066 [01:19<03:47,  3.42it/s] 27%|██▋       | 287/1066 [01:19<03:42,  3.50it/s] 27%|██▋       | 288/1066 [01:20<03:37,  3.58it/s] 27%|██▋       | 289/1066 [01:20<03:34,  3.62it/s] 27%|██▋       | 290/1066 [01:20<03:37,  3.57it/s] 27%|██▋       | 291/1066 [01:21<03:34,  3.61it/s] 27%|██▋       | 292/1066 [01:21<03:34,  3.60it/s] 27%|██▋       | 293/1066 [01:21<03:38,  3.54it/s] 28%|██▊       | 294/1066 [01:21<03:39,  3.52it/s] 28%|██▊       | 295/1066 [01:22<04:01,  3.19it/s] 28%|██▊       | 296/1066 [01:22<03:53,  3.30it/s] 28%|██▊       | 297/1066 [01:22<03:46,  3.39it/s] 28%|██▊       | 298/1066 [01:23<03:42,  3.45it/s] 28%|██▊       | 299/1066 [01:23<03:36,  3.54it/s] 28%|██▊       | 300/1066 [01:23<03:30,  3.63it/s] 28%|██▊       | 301/1066 [01:23<03:26,  3.70it/s] 28%|██▊       | 302/1066 [01:24<03:26,  3.70it/s] 28%|██▊       | 303/1066 [01:24<03:27,  3.67it/s] 29%|██▊       | 304/1066 [01:24<03:23,  3.74it/s] 29%|██▊       | 305/1066 [01:24<03:20,  3.79it/s] 29%|██▊       | 306/1066 [01:25<03:21,  3.78it/s] 29%|██▉       | 307/1066 [01:25<03:20,  3.79it/s] 29%|██▉       | 308/1066 [01:25<03:42,  3.41it/s] 29%|██▉       | 309/1066 [01:26<03:38,  3.47it/s] 29%|██▉       | 310/1066 [01:26<03:33,  3.55it/s] 29%|██▉       | 311/1066 [01:26<03:29,  3.61it/s] 29%|██▉       | 312/1066 [01:26<03:27,  3.63it/s] 29%|██▉       | 313/1066 [01:27<03:23,  3.70it/s] 29%|██▉       | 314/1066 [01:27<03:25,  3.66it/s] 30%|██▉       | 315/1066 [01:27<03:23,  3.70it/s] 30%|██▉       | 316/1066 [01:28<03:25,  3.66it/s] 30%|██▉       | 317/1066 [01:28<03:27,  3.61it/s] 30%|██▉       | 318/1066 [01:28<03:25,  3.63it/s] 30%|██▉       | 319/1066 [01:28<03:49,  3.25it/s] 30%|███       | 320/1066 [01:29<03:42,  3.36it/s] 30%|███       | 321/1066 [01:29<03:33,  3.48it/s] 30%|███       | 322/1066 [01:29<03:30,  3.54it/s] 30%|███       | 323/1066 [01:30<03:27,  3.59it/s] 30%|███       | 324/1066 [01:30<03:22,  3.66it/s] 30%|███       | 325/1066 [01:30<03:19,  3.72it/s] 31%|███       | 326/1066 [01:30<03:18,  3.73it/s] 31%|███       | 327/1066 [01:31<03:21,  3.66it/s] 31%|███       | 328/1066 [01:31<03:21,  3.66it/s] 31%|███       | 329/1066 [01:31<03:20,  3.67it/s] 31%|███       | 330/1066 [01:31<03:20,  3.67it/s] 31%|███       | 331/1066 [01:32<03:43,  3.29it/s] 31%|███       | 332/1066 [01:32<03:39,  3.34it/s] 31%|███       | 333/1066 [01:32<03:32,  3.44it/s] 31%|███▏      | 334/1066 [01:33<03:31,  3.46it/s] 31%|███▏      | 335/1066 [01:33<03:26,  3.54it/s] 32%|███▏      | 336/1066 [01:33<03:19,  3.66it/s] 32%|███▏      | 337/1066 [01:33<03:16,  3.71it/s] 32%|███▏      | 338/1066 [01:34<03:14,  3.74it/s] 32%|███▏      | 339/1066 [01:34<03:14,  3.74it/s] 32%|███▏      | 340/1066 [01:34<03:15,  3.72it/s] 32%|███▏      | 341/1066 [01:35<03:17,  3.67it/s] 32%|███▏      | 342/1066 [01:35<03:18,  3.64it/s] 32%|███▏      | 343/1066 [01:35<03:18,  3.64it/s] 32%|███▏      | 344/1066 [01:35<03:44,  3.22it/s] 32%|███▏      | 345/1066 [01:36<03:35,  3.34it/s] 32%|███▏      | 346/1066 [01:36<03:29,  3.44it/s] 33%|███▎      | 347/1066 [01:36<03:25,  3.51it/s] 33%|███▎      | 348/1066 [01:37<03:20,  3.59it/s] 33%|███▎      | 349/1066 [01:37<03:16,  3.66it/s] 33%|███▎      | 350/1066 [01:37<03:15,  3.66it/s] 33%|███▎      | 351/1066 [01:37<03:16,  3.63it/s] 33%|███▎      | 352/1066 [01:38<03:14,  3.67it/s] 33%|███▎      | 353/1066 [01:38<03:17,  3.60it/s] 33%|███▎      | 354/1066 [01:38<03:14,  3.66it/s] 33%|███▎      | 355/1066 [01:38<03:16,  3.61it/s] 33%|███▎      | 356/1066 [01:39<03:17,  3.60it/s] 33%|███▎      | 357/1066 [01:39<03:38,  3.25it/s] 34%|███▎      | 358/1066 [01:39<03:32,  3.33it/s] 34%|███▎      | 359/1066 [01:40<03:25,  3.43it/s] 34%|███▍      | 360/1066 [01:40<03:23,  3.48it/s] 34%|███▍      | 361/1066 [01:40<03:19,  3.54it/s] 34%|███▍      | 362/1066 [01:40<03:12,  3.65it/s] 34%|███▍      | 363/1066 [01:41<03:10,  3.69it/s] 34%|███▍      | 364/1066 [01:41<03:11,  3.67it/s] 34%|███▍      | 365/1066 [01:41<03:11,  3.67it/s] 34%|███▍      | 366/1066 [01:42<03:09,  3.69it/s] 34%|███▍      | 367/1066 [01:42<03:09,  3.68it/s] 35%|███▍      | 368/1066 [01:42<03:17,  3.53it/s] 35%|███▍      | 369/1066 [01:42<03:15,  3.57it/s] 35%|███▍      | 370/1066 [01:43<03:14,  3.58it/s] 35%|███▍      | 371/1066 [01:43<03:13,  3.59it/s] 35%|███▍      | 372/1066 [01:43<03:16,  3.52it/s] 35%|███▍      | 373/1066 [01:44<03:14,  3.57it/s] 35%|███▌      | 374/1066 [01:44<03:13,  3.57it/s] 35%|███▌      | 375/1066 [01:44<03:12,  3.60it/s] 35%|███▌      | 376/1066 [01:44<03:09,  3.63it/s] 35%|███▌      | 377/1066 [01:45<03:12,  3.58it/s] 35%|███▌      | 378/1066 [01:45<03:11,  3.59it/s] 36%|███▌      | 379/1066 [01:45<03:10,  3.60it/s] 36%|███▌      | 380/1066 [01:45<03:13,  3.54it/s] 36%|███▌      | 381/1066 [01:46<03:11,  3.57it/s] 36%|███▌      | 382/1066 [01:46<03:15,  3.49it/s] 36%|███▌      | 383/1066 [01:46<03:11,  3.57it/s] 36%|███▌      | 384/1066 [01:47<03:13,  3.53it/s] 36%|███▌      | 385/1066 [01:47<03:06,  3.65it/s] 36%|███▌      | 386/1066 [01:47<03:05,  3.66it/s] 36%|███▋      | 387/1066 [01:47<03:06,  3.64it/s] 36%|███▋      | 388/1066 [01:48<03:03,  3.69it/s] 36%|███▋      | 389/1066 [01:48<03:10,  3.54it/s] 37%|███▋      | 390/1066 [01:48<03:09,  3.57it/s] 37%|███▋      | 391/1066 [01:49<03:14,  3.47it/s] 37%|███▋      | 392/1066 [01:49<03:13,  3.48it/s] 37%|███▋      | 393/1066 [01:49<03:13,  3.47it/s] 37%|███▋      | 394/1066 [01:49<03:09,  3.54it/s] 37%|███▋      | 395/1066 [01:50<03:13,  3.48it/s] 37%|███▋      | 396/1066 [01:50<03:10,  3.52it/s] 37%|███▋      | 397/1066 [01:50<03:09,  3.53it/s] 37%|███▋      | 398/1066 [01:51<03:04,  3.63it/s] 37%|███▋      | 399/1066 [01:51<03:03,  3.64it/s] 38%|███▊      | 400/1066 [01:51<03:04,  3.61it/s] 38%|███▊      | 401/1066 [01:51<03:04,  3.60it/s] 38%|███▊      | 402/1066 [01:52<03:04,  3.59it/s] 38%|███▊      | 403/1066 [01:52<03:08,  3.52it/s] 38%|███▊      | 404/1066 [01:52<03:07,  3.52it/s] 38%|███▊      | 405/1066 [01:53<03:09,  3.48it/s] 38%|███▊      | 406/1066 [01:53<03:10,  3.46it/s] 38%|███▊      | 407/1066 [01:53<03:09,  3.47it/s] 38%|███▊      | 408/1066 [01:53<03:08,  3.50it/s] 38%|███▊      | 409/1066 [01:54<03:07,  3.50it/s] 38%|███▊      | 410/1066 [01:54<03:04,  3.56it/s] 39%|███▊      | 411/1066 [01:54<03:02,  3.60it/s] 39%|███▊      | 412/1066 [01:54<03:02,  3.58it/s] 39%|███▊      | 413/1066 [01:55<02:59,  3.64it/s] 39%|███▉      | 414/1066 [01:55<02:58,  3.65it/s] 39%|███▉      | 415/1066 [01:55<03:00,  3.60it/s] 39%|███▉      | 416/1066 [01:56<03:01,  3.58it/s] 39%|███▉      | 417/1066 [01:56<03:02,  3.55it/s] 39%|███▉      | 418/1066 [01:56<03:04,  3.52it/s] 39%|███▉      | 419/1066 [01:56<03:01,  3.56it/s] 39%|███▉      | 420/1066 [01:57<03:01,  3.55it/s] 39%|███▉      | 421/1066 [01:57<03:04,  3.50it/s] 40%|███▉      | 422/1066 [01:57<03:03,  3.52it/s] 40%|███▉      | 423/1066 [01:58<03:01,  3.54it/s] 40%|███▉      | 424/1066 [01:58<02:58,  3.59it/s] 40%|███▉      | 425/1066 [01:58<02:57,  3.61it/s] 40%|███▉      | 426/1066 [01:58<02:56,  3.62it/s] 40%|████      | 427/1066 [01:59<02:58,  3.59it/s] 40%|████      | 428/1066 [01:59<02:56,  3.62it/s] 40%|████      | 429/1066 [01:59<02:56,  3.61it/s] 40%|████      | 430/1066 [02:00<02:58,  3.56it/s] 40%|████      | 431/1066 [02:00<02:56,  3.60it/s] 41%|████      | 432/1066 [02:00<02:58,  3.55it/s] 41%|████      | 433/1066 [02:00<02:57,  3.58it/s] 41%|████      | 434/1066 [02:01<02:59,  3.52it/s] 41%|████      | 435/1066 [02:01<02:56,  3.57it/s] 41%|████      | 436/1066 [02:01<02:53,  3.63it/s] 41%|████      | 437/1066 [02:01<02:56,  3.57it/s] 41%|████      | 438/1066 [02:02<02:52,  3.64it/s] 41%|████      | 439/1066 [02:02<02:57,  3.54it/s] 41%|████▏     | 440/1066 [02:02<02:55,  3.57it/s] 41%|████▏     | 441/1066 [02:03<03:00,  3.47it/s] 41%|████▏     | 442/1066 [02:03<02:57,  3.52it/s] 42%|████▏     | 443/1066 [02:03<02:57,  3.51it/s] 42%|████▏     | 444/1066 [02:03<02:53,  3.58it/s] 42%|████▏     | 445/1066 [02:04<02:50,  3.64it/s] 42%|████▏     | 446/1066 [02:04<02:54,  3.56it/s] 42%|████▏     | 447/1066 [02:04<02:50,  3.63it/s] 42%|████▏     | 448/1066 [02:05<02:52,  3.59it/s] 42%|████▏     | 449/1066 [02:05<02:47,  3.67it/s] 42%|████▏     | 450/1066 [02:05<02:49,  3.64it/s] 42%|████▏     | 451/1066 [02:05<02:45,  3.71it/s] 42%|████▏     | 452/1066 [02:06<02:43,  3.75it/s] 42%|████▏     | 453/1066 [02:06<02:47,  3.66it/s] 43%|████▎     | 454/1066 [02:06<02:47,  3.66it/s] 43%|████▎     | 455/1066 [02:06<02:50,  3.58it/s] 43%|████▎     | 456/1066 [02:07<02:49,  3.61it/s] 43%|████▎     | 457/1066 [02:07<02:46,  3.66it/s] 43%|████▎     | 458/1066 [02:07<02:46,  3.65it/s] 43%|████▎     | 459/1066 [02:08<02:46,  3.65it/s] 43%|████▎     | 460/1066 [02:08<02:46,  3.63it/s] 43%|████▎     | 461/1066 [02:08<02:45,  3.65it/s] 43%|████▎     | 462/1066 [02:08<02:43,  3.69it/s] 43%|████▎     | 463/1066 [02:09<02:46,  3.63it/s] 44%|████▎     | 464/1066 [02:09<02:49,  3.56it/s] 44%|████▎     | 465/1066 [02:09<02:46,  3.61it/s] 44%|████▎     | 466/1066 [02:10<02:46,  3.60it/s] 44%|████▍     | 467/1066 [02:10<02:50,  3.51it/s] 44%|████▍     | 468/1066 [02:10<02:47,  3.56it/s] 44%|████▍     | 469/1066 [02:10<02:49,  3.52it/s] 44%|████▍     | 470/1066 [02:11<02:44,  3.63it/s] 44%|████▍     | 471/1066 [02:11<02:45,  3.59it/s] 44%|████▍     | 472/1066 [02:11<02:43,  3.63it/s] 44%|████▍     | 473/1066 [02:11<02:39,  3.71it/s] 44%|████▍     | 474/1066 [02:12<02:40,  3.68it/s] 45%|████▍     | 475/1066 [02:12<02:36,  3.78it/s] 45%|████▍     | 476/1066 [02:12<02:39,  3.70it/s] 45%|████▍     | 477/1066 [02:13<02:38,  3.71it/s] 45%|████▍     | 478/1066 [02:13<02:41,  3.63it/s] 45%|████▍     | 479/1066 [02:13<02:46,  3.53it/s] 45%|████▌     | 480/1066 [02:13<02:42,  3.61it/s] 45%|████▌     | 481/1066 [02:14<02:45,  3.53it/s] 45%|████▌     | 482/1066 [02:14<02:43,  3.57it/s] 45%|████▌     | 483/1066 [02:14<02:43,  3.56it/s] 45%|████▌     | 484/1066 [02:14<02:40,  3.63it/s] 45%|████▌     | 485/1066 [02:15<02:39,  3.65it/s] 46%|████▌     | 486/1066 [02:15<02:40,  3.61it/s] 46%|████▌     | 487/1066 [02:15<02:36,  3.70it/s] 46%|████▌     | 488/1066 [02:16<02:39,  3.63it/s] 46%|████▌     | 489/1066 [02:16<02:37,  3.65it/s] 46%|████▌     | 490/1066 [02:16<02:36,  3.67it/s] 46%|████▌     | 491/1066 [02:16<02:39,  3.60it/s] 46%|████▌     | 492/1066 [02:17<02:39,  3.61it/s] 46%|████▌     | 493/1066 [02:17<02:41,  3.55it/s] 46%|████▋     | 494/1066 [02:17<02:41,  3.55it/s] 46%|████▋     | 495/1066 [02:18<02:38,  3.60it/s] 47%|████▋     | 496/1066 [02:18<02:34,  3.69it/s] 47%|████▋     | 497/1066 [02:18<02:36,  3.64it/s] 47%|████▋     | 498/1066 [02:18<02:38,  3.59it/s] 47%|████▋     | 499/1066 [02:19<02:34,  3.66it/s] 47%|████▋     | 500/1066 [02:19<02:38,  3.57it/s] 47%|████▋     | 501/1066 [02:19<02:36,  3.61it/s] 47%|████▋     | 502/1066 [02:19<02:38,  3.56it/s] 47%|████▋     | 503/1066 [02:20<02:38,  3.55it/s] 47%|████▋     | 504/1066 [02:20<02:38,  3.55it/s] 47%|████▋     | 505/1066 [02:20<02:42,  3.45it/s] 47%|████▋     | 506/1066 [02:21<02:41,  3.47it/s] 48%|████▊     | 507/1066 [02:21<02:37,  3.54it/s] 48%|████▊     | 508/1066 [02:21<02:40,  3.48it/s] 48%|████▊     | 509/1066 [02:21<02:38,  3.52it/s] 48%|████▊     | 510/1066 [02:22<02:38,  3.51it/s] 48%|████▊     | 511/1066 [02:22<02:35,  3.57it/s] 48%|████▊     | 512/1066 [02:22<02:32,  3.63it/s] 48%|████▊     | 513/1066 [02:23<02:34,  3.57it/s] 48%|████▊     | 514/1066 [02:23<02:35,  3.55it/s] 48%|████▊     | 515/1066 [02:23<02:38,  3.47it/s] 48%|████▊     | 516/1066 [02:23<02:35,  3.54it/s] 48%|████▊     | 517/1066 [02:24<02:34,  3.55it/s] 49%|████▊     | 518/1066 [02:24<02:34,  3.54it/s] 49%|████▊     | 519/1066 [02:24<02:33,  3.57it/s] 49%|████▉     | 520/1066 [02:25<02:34,  3.54it/s] 49%|████▉     | 521/1066 [02:25<02:33,  3.56it/s] 49%|████▉     | 522/1066 [02:25<02:28,  3.67it/s] 49%|████▉     | 523/1066 [02:25<02:30,  3.60it/s] 49%|████▉     | 524/1066 [02:26<02:28,  3.64it/s] 49%|████▉     | 525/1066 [02:26<02:31,  3.57it/s] 49%|████▉     | 526/1066 [02:26<02:28,  3.64it/s] 49%|████▉     | 527/1066 [02:26<02:28,  3.62it/s] 50%|████▉     | 528/1066 [02:27<02:32,  3.54it/s] 50%|████▉     | 529/1066 [02:27<02:29,  3.59it/s] 50%|████▉     | 530/1066 [02:27<02:31,  3.53it/s] 50%|████▉     | 531/1066 [02:28<02:30,  3.55it/s] 50%|████▉     | 532/1066 [02:28<02:33,  3.48it/s] 50%|█████     | 533/1066 [02:28<02:30,  3.54it/s] 50%|█████     | 534/1066 [02:28<02:28,  3.59it/s] 50%|█████     | 535/1066 [02:29<02:28,  3.58it/s] 50%|█████     | 536/1066 [02:29<02:29,  3.55it/s] 50%|█████     | 537/1066 [02:29<02:30,  3.51it/s] 50%|█████     | 538/1066 [02:30<02:26,  3.59it/s] 51%|█████     | 539/1066 [02:30<02:23,  3.69it/s] 51%|█████     | 540/1066 [02:30<02:28,  3.55it/s] 51%|█████     | 541/1066 [02:30<02:25,  3.62it/s] 51%|█████     | 542/1066 [02:31<02:25,  3.60it/s] 51%|█████     | 543/1066 [02:31<02:24,  3.61it/s] 51%|█████     | 544/1066 [02:31<02:25,  3.59it/s] 51%|█████     | 545/1066 [02:32<02:25,  3.59it/s] 51%|█████     | 546/1066 [02:32<02:22,  3.66it/s] 51%|█████▏    | 547/1066 [02:32<02:22,  3.63it/s] 51%|█████▏    | 548/1066 [02:32<02:20,  3.69it/s] 52%|█████▏    | 549/1066 [02:33<02:23,  3.60it/s] 52%|█████▏    | 550/1066 [02:33<02:23,  3.61it/s] 52%|█████▏    | 551/1066 [02:33<02:23,  3.60it/s] 52%|█████▏    | 552/1066 [02:33<02:24,  3.56it/s] 52%|█████▏    | 553/1066 [02:34<02:23,  3.58it/s] 52%|█████▏    | 554/1066 [02:34<02:24,  3.54it/s] 52%|█████▏    | 555/1066 [02:34<02:22,  3.59it/s] 52%|█████▏    | 556/1066 [02:35<02:21,  3.61it/s] 52%|█████▏    | 557/1066 [02:35<02:19,  3.64it/s] 52%|█████▏    | 558/1066 [02:35<02:20,  3.61it/s] 52%|█████▏    | 559/1066 [02:35<02:20,  3.61it/s] 53%|█████▎    | 560/1066 [02:36<02:16,  3.72it/s] 53%|█████▎    | 561/1066 [02:36<02:18,  3.64it/s] 53%|█████▎    | 562/1066 [02:36<02:17,  3.66it/s] 53%|█████▎    | 563/1066 [02:37<02:19,  3.60it/s] 53%|█████▎    | 564/1066 [02:37<02:21,  3.54it/s] 53%|█████▎    | 565/1066 [02:37<02:19,  3.59it/s] 53%|█████▎    | 566/1066 [02:37<02:18,  3.60it/s] 53%|█████▎    | 567/1066 [02:38<02:16,  3.65it/s] 53%|█████▎    | 568/1066 [02:38<02:14,  3.70it/s] 53%|█████▎    | 569/1066 [02:38<02:16,  3.64it/s] 53%|█████▎    | 570/1066 [02:38<02:13,  3.71it/s] 54%|█████▎    | 571/1066 [02:39<02:17,  3.60it/s] 54%|█████▎    | 572/1066 [02:39<02:15,  3.66it/s] 54%|█████▍    | 573/1066 [02:39<02:14,  3.66it/s] 54%|█████▍    | 574/1066 [02:40<02:16,  3.61it/s] 54%|█████▍    | 575/1066 [02:40<02:15,  3.64it/s] 54%|█████▍    | 576/1066 [02:40<02:19,  3.51it/s] 54%|█████▍    | 577/1066 [02:40<02:16,  3.57it/s] 54%|█████▍    | 578/1066 [02:41<02:15,  3.61it/s] 54%|█████▍    | 579/1066 [02:41<02:15,  3.59it/s] 54%|█████▍    | 580/1066 [02:41<02:12,  3.67it/s] 55%|█████▍    | 581/1066 [02:41<02:12,  3.66it/s] 55%|█████▍    | 582/1066 [02:42<02:11,  3.69it/s] 55%|█████▍    | 583/1066 [02:42<02:10,  3.69it/s] 55%|█████▍    | 584/1066 [02:42<02:11,  3.66it/s] 55%|█████▍    | 585/1066 [02:43<02:10,  3.68it/s] 55%|█████▍    | 586/1066 [02:43<02:09,  3.70it/s] 55%|█████▌    | 587/1066 [02:43<02:11,  3.65it/s] 55%|█████▌    | 588/1066 [02:43<02:11,  3.63it/s] 55%|█████▌    | 589/1066 [02:44<02:12,  3.59it/s] 55%|█████▌    | 590/1066 [02:44<02:11,  3.61it/s] 55%|█████▌    | 591/1066 [02:44<02:13,  3.56it/s] 56%|█████▌    | 592/1066 [02:45<02:13,  3.55it/s] 56%|█████▌    | 593/1066 [02:45<02:12,  3.57it/s] 56%|█████▌    | 594/1066 [02:45<02:11,  3.60it/s] 56%|█████▌    | 595/1066 [02:45<02:08,  3.65it/s] 56%|█████▌    | 596/1066 [02:46<02:09,  3.64it/s] 56%|█████▌    | 597/1066 [02:46<02:07,  3.67it/s] 56%|█████▌    | 598/1066 [02:46<02:06,  3.69it/s] 56%|█████▌    | 599/1066 [02:46<02:09,  3.61it/s] 56%|█████▋    | 600/1066 [02:47<02:08,  3.63it/s] 56%|█████▋    | 601/1066 [02:47<02:09,  3.59it/s] 56%|█████▋    | 602/1066 [02:47<02:09,  3.58it/s] 57%|█████▋    | 603/1066 [02:48<02:06,  3.65it/s] 57%|█████▋    | 604/1066 [02:48<02:08,  3.59it/s] 57%|█████▋    | 605/1066 [02:48<02:06,  3.63it/s] 57%|█████▋    | 606/1066 [02:48<02:08,  3.57it/s] 57%|█████▋    | 607/1066 [02:49<02:07,  3.61it/s] 57%|█████▋    | 608/1066 [02:49<02:05,  3.66it/s] 57%|█████▋    | 609/1066 [02:49<02:05,  3.63it/s] 57%|█████▋    | 610/1066 [02:49<02:05,  3.63it/s] 57%|█████▋    | 611/1066 [02:50<02:07,  3.57it/s] 57%|█████▋    | 612/1066 [02:50<02:06,  3.60it/s] 58%|█████▊    | 613/1066 [02:50<02:05,  3.62it/s] 58%|█████▊    | 614/1066 [02:51<02:07,  3.55it/s] 58%|█████▊    | 615/1066 [02:51<02:04,  3.63it/s] 58%|█████▊    | 616/1066 [02:51<02:05,  3.60it/s] 58%|█████▊    | 617/1066 [02:51<02:02,  3.65it/s] 58%|█████▊    | 618/1066 [02:52<02:02,  3.67it/s] 58%|█████▊    | 619/1066 [02:52<02:03,  3.62it/s] 58%|█████▊    | 620/1066 [02:52<02:00,  3.69it/s] 58%|█████▊    | 621/1066 [02:53<02:03,  3.61it/s] 58%|█████▊    | 622/1066 [02:53<02:01,  3.65it/s] 58%|█████▊    | 623/1066 [02:53<02:01,  3.65it/s] 59%|█████▊    | 624/1066 [02:53<01:59,  3.69it/s] 59%|█████▊    | 625/1066 [02:54<02:00,  3.65it/s] 59%|█████▊    | 626/1066 [02:54<02:02,  3.61it/s] 59%|█████▉    | 627/1066 [02:54<01:59,  3.69it/s] 59%|█████▉    | 628/1066 [02:54<02:01,  3.60it/s] 59%|█████▉    | 629/1066 [02:55<02:00,  3.62it/s] 59%|█████▉    | 630/1066 [02:55<01:59,  3.66it/s] 59%|█████▉    | 631/1066 [02:55<01:59,  3.63it/s] 59%|█████▉    | 632/1066 [02:56<01:58,  3.66it/s] 59%|█████▉    | 633/1066 [02:56<01:56,  3.72it/s] 59%|█████▉    | 634/1066 [02:56<01:59,  3.62it/s] 60%|█████▉    | 635/1066 [02:56<01:57,  3.68it/s] 60%|█████▉    | 636/1066 [02:57<01:59,  3.59it/s] 60%|█████▉    | 637/1066 [02:57<01:59,  3.58it/s] 60%|█████▉    | 638/1066 [02:57<02:00,  3.56it/s] 60%|█████▉    | 639/1066 [02:57<01:59,  3.56it/s] 60%|██████    | 640/1066 [02:58<01:58,  3.59it/s] 60%|██████    | 641/1066 [02:58<01:59,  3.57it/s] 60%|██████    | 642/1066 [02:58<01:58,  3.59it/s] 60%|██████    | 643/1066 [02:59<01:55,  3.68it/s] 60%|██████    | 644/1066 [02:59<01:57,  3.59it/s] 61%|██████    | 645/1066 [02:59<01:55,  3.64it/s] 61%|██████    | 646/1066 [02:59<01:55,  3.63it/s] 61%|██████    | 647/1066 [03:00<01:54,  3.65it/s] 61%|██████    | 648/1066 [03:00<01:54,  3.64it/s] 61%|██████    | 649/1066 [03:00<01:57,  3.54it/s] 61%|██████    | 650/1066 [03:01<01:55,  3.61it/s] 61%|██████    | 651/1066 [03:01<01:57,  3.54it/s] 61%|██████    | 652/1066 [03:01<01:56,  3.56it/s] 61%|██████▏   | 653/1066 [03:01<01:54,  3.61it/s] 61%|██████▏   | 654/1066 [03:02<02:05,  3.29it/s] 61%|██████▏   | 655/1066 [03:02<02:00,  3.42it/s] 62%|██████▏   | 656/1066 [03:02<01:55,  3.55it/s] 62%|██████▏   | 657/1066 [03:02<01:52,  3.63it/s] 62%|██████▏   | 658/1066 [03:03<01:50,  3.68it/s] 62%|██████▏   | 659/1066 [03:03<01:50,  3.69it/s] 62%|██████▏   | 660/1066 [03:03<01:50,  3.68it/s] 62%|██████▏   | 661/1066 [03:04<01:51,  3.62it/s] 62%|██████▏   | 662/1066 [03:04<01:51,  3.63it/s] 62%|██████▏   | 663/1066 [03:04<01:49,  3.68it/s] 62%|██████▏   | 664/1066 [03:04<01:49,  3.68it/s] 62%|██████▏   | 665/1066 [03:05<01:59,  3.37it/s] 62%|██████▏   | 666/1066 [03:05<01:55,  3.45it/s] 63%|██████▎   | 667/1066 [03:05<01:52,  3.56it/s] 63%|██████▎   | 668/1066 [03:06<01:50,  3.61it/s] 63%|██████▎   | 669/1066 [03:06<01:49,  3.63it/s] 63%|██████▎   | 670/1066 [03:06<01:45,  3.74it/s] 63%|██████▎   | 671/1066 [03:06<01:44,  3.77it/s] 63%|██████▎   | 672/1066 [03:07<01:43,  3.82it/s] 63%|██████▎   | 673/1066 [03:07<01:42,  3.82it/s] 63%|██████▎   | 674/1066 [03:07<01:43,  3.79it/s] 63%|██████▎   | 675/1066 [03:07<01:44,  3.74it/s] 63%|██████▎   | 676/1066 [03:08<01:45,  3.69it/s] 64%|██████▎   | 677/1066 [03:08<01:55,  3.36it/s] 64%|██████▎   | 678/1066 [03:08<01:52,  3.44it/s] 64%|██████▎   | 679/1066 [03:09<01:50,  3.50it/s] 64%|██████▍   | 680/1066 [03:09<01:48,  3.54it/s] 64%|██████▍   | 681/1066 [03:09<01:45,  3.64it/s] 64%|██████▍   | 682/1066 [03:09<01:43,  3.70it/s] 64%|██████▍   | 683/1066 [03:10<01:44,  3.66it/s] 64%|██████▍   | 684/1066 [03:10<01:43,  3.67it/s] 64%|██████▍   | 685/1066 [03:10<01:42,  3.70it/s] 64%|██████▍   | 686/1066 [03:10<01:41,  3.74it/s] 64%|██████▍   | 687/1066 [03:11<01:42,  3.68it/s] 65%|██████▍   | 688/1066 [03:11<01:42,  3.68it/s] 65%|██████▍   | 689/1066 [03:11<01:48,  3.48it/s] 65%|██████▍   | 690/1066 [03:12<01:45,  3.58it/s] 65%|██████▍   | 691/1066 [03:12<01:43,  3.64it/s] 65%|██████▍   | 692/1066 [03:12<01:41,  3.70it/s] 65%|██████▌   | 693/1066 [03:12<01:40,  3.70it/s] 65%|██████▌   | 694/1066 [03:13<01:41,  3.66it/s] 65%|██████▌   | 695/1066 [03:13<01:43,  3.57it/s] 65%|██████▌   | 696/1066 [03:13<01:43,  3.57it/s] 65%|██████▌   | 697/1066 [03:14<01:50,  3.34it/s] 65%|██████▌   | 698/1066 [03:14<01:46,  3.45it/s] 66%|██████▌   | 699/1066 [03:14<01:44,  3.52it/s] 66%|██████▌   | 700/1066 [03:14<01:43,  3.54it/s] 66%|██████▌   | 701/1066 [03:15<01:41,  3.61it/s] 66%|██████▌   | 702/1066 [03:15<01:40,  3.64it/s] 66%|██████▌   | 703/1066 [03:15<01:40,  3.63it/s] 66%|██████▌   | 704/1066 [03:15<01:38,  3.68it/s] 66%|██████▌   | 705/1066 [03:16<01:37,  3.70it/s] 66%|██████▌   | 706/1066 [03:16<01:37,  3.71it/s] 66%|██████▋   | 707/1066 [03:16<01:36,  3.72it/s] 66%|██████▋   | 708/1066 [03:17<01:48,  3.31it/s] 67%|██████▋   | 709/1066 [03:17<01:43,  3.43it/s] 67%|██████▋   | 710/1066 [03:17<01:43,  3.45it/s] 67%|██████▋   | 711/1066 [03:17<01:41,  3.49it/s] 67%|██████▋   | 712/1066 [03:18<01:39,  3.55it/s] 67%|██████▋   | 713/1066 [03:18<01:39,  3.56it/s] 67%|██████▋   | 714/1066 [03:18<01:37,  3.61it/s] 67%|██████▋   | 715/1066 [03:19<01:38,  3.57it/s] 67%|██████▋   | 716/1066 [03:19<01:37,  3.58it/s] 67%|██████▋   | 717/1066 [03:19<01:35,  3.64it/s] 67%|██████▋   | 718/1066 [03:19<01:34,  3.67it/s] 67%|██████▋   | 719/1066 [03:20<01:46,  3.27it/s] 68%|██████▊   | 720/1066 [03:20<01:42,  3.37it/s] 68%|██████▊   | 721/1066 [03:20<01:40,  3.45it/s] 68%|██████▊   | 722/1066 [03:21<01:38,  3.50it/s] 68%|██████▊   | 723/1066 [03:21<01:35,  3.58it/s] 68%|██████▊   | 724/1066 [03:21<01:36,  3.54it/s] 68%|██████▊   | 725/1066 [03:21<01:37,  3.50it/s] 68%|██████▊   | 726/1066 [03:22<01:36,  3.53it/s] 68%|██████▊   | 727/1066 [03:22<01:35,  3.56it/s] 68%|██████▊   | 728/1066 [03:22<01:34,  3.58it/s] 68%|██████▊   | 729/1066 [03:23<01:33,  3.61it/s] 68%|██████▊   | 730/1066 [03:23<01:30,  3.72it/s] 69%|██████▊   | 731/1066 [03:23<01:41,  3.31it/s] 69%|██████▊   | 732/1066 [03:23<01:38,  3.39it/s] 69%|██████▉   | 733/1066 [03:24<01:37,  3.41it/s] 69%|██████▉   | 734/1066 [03:24<01:36,  3.45it/s] 69%|██████▉   | 735/1066 [03:24<01:33,  3.53it/s] 69%|██████▉   | 736/1066 [03:25<01:33,  3.52it/s] 69%|██████▉   | 737/1066 [03:25<01:32,  3.54it/s] 69%|██████▉   | 738/1066 [03:25<01:32,  3.53it/s] 69%|██████▉   | 739/1066 [03:25<01:32,  3.54it/s] 69%|██████▉   | 740/1066 [03:26<01:32,  3.53it/s] 70%|██████▉   | 741/1066 [03:26<01:30,  3.60it/s] 70%|██████▉   | 742/1066 [03:26<01:27,  3.71it/s] 70%|██████▉   | 743/1066 [03:26<01:25,  3.76it/s] 70%|██████▉   | 744/1066 [03:27<01:25,  3.78it/s] 70%|██████▉   | 745/1066 [03:27<01:26,  3.69it/s] 70%|██████▉   | 746/1066 [03:27<01:36,  3.31it/s] 70%|███████   | 747/1066 [03:28<01:33,  3.40it/s] 70%|███████   | 748/1066 [03:28<01:32,  3.42it/s] 70%|███████   | 749/1066 [03:28<01:32,  3.45it/s] 70%|███████   | 750/1066 [03:29<01:29,  3.52it/s] 70%|███████   | 751/1066 [03:29<01:28,  3.57it/s] 71%|███████   | 752/1066 [03:29<01:28,  3.56it/s] 71%|███████   | 753/1066 [03:29<01:28,  3.53it/s] 71%|███████   | 754/1066 [03:30<01:26,  3.59it/s] 71%|███████   | 755/1066 [03:30<01:24,  3.67it/s] 71%|███████   | 756/1066 [03:30<01:25,  3.64it/s] 71%|███████   | 757/1066 [03:30<01:25,  3.61it/s] 71%|███████   | 758/1066 [03:31<01:25,  3.59it/s] 71%|███████   | 759/1066 [03:31<01:35,  3.22it/s] 71%|███████▏  | 760/1066 [03:31<01:32,  3.31it/s] 71%|███████▏  | 761/1066 [03:32<01:29,  3.41it/s] 71%|███████▏  | 762/1066 [03:32<01:28,  3.43it/s] 72%|███████▏  | 763/1066 [03:32<01:25,  3.53it/s] 72%|███████▏  | 764/1066 [03:33<01:24,  3.59it/s] 72%|███████▏  | 765/1066 [03:33<01:24,  3.58it/s] 72%|███████▏  | 766/1066 [03:33<01:21,  3.67it/s] 72%|███████▏  | 767/1066 [03:33<01:20,  3.73it/s] 72%|███████▏  | 768/1066 [03:34<01:20,  3.70it/s] 72%|███████▏  | 769/1066 [03:34<01:20,  3.70it/s] 72%|███████▏  | 770/1066 [03:34<01:22,  3.59it/s] 72%|███████▏  | 771/1066 [03:34<01:21,  3.61it/s] 72%|███████▏  | 772/1066 [03:35<01:24,  3.49it/s] 73%|███████▎  | 773/1066 [03:35<01:23,  3.50it/s] 73%|███████▎  | 774/1066 [03:35<01:23,  3.51it/s] 73%|███████▎  | 775/1066 [03:36<01:23,  3.47it/s] 73%|███████▎  | 776/1066 [03:36<01:21,  3.54it/s] 73%|███████▎  | 777/1066 [03:36<01:22,  3.52it/s] 73%|███████▎  | 778/1066 [03:36<01:19,  3.62it/s] 73%|███████▎  | 779/1066 [03:37<01:16,  3.75it/s] 73%|███████▎  | 780/1066 [03:37<01:19,  3.61it/s] 73%|███████▎  | 781/1066 [03:37<01:18,  3.61it/s] 73%|███████▎  | 782/1066 [03:37<01:17,  3.67it/s] 73%|███████▎  | 783/1066 [03:38<01:17,  3.63it/s] 74%|███████▎  | 784/1066 [03:38<01:18,  3.58it/s] 74%|███████▎  | 785/1066 [03:38<01:19,  3.52it/s] 74%|███████▎  | 786/1066 [03:39<01:20,  3.49it/s] 74%|███████▍  | 787/1066 [03:39<01:20,  3.49it/s] 74%|███████▍  | 788/1066 [03:39<01:19,  3.50it/s] 74%|███████▍  | 789/1066 [03:40<01:19,  3.51it/s] 74%|███████▍  | 790/1066 [03:40<01:18,  3.52it/s] 74%|███████▍  | 791/1066 [03:40<01:16,  3.60it/s] 74%|███████▍  | 792/1066 [03:40<01:14,  3.69it/s] 74%|███████▍  | 793/1066 [03:41<01:14,  3.68it/s] 74%|███████▍  | 794/1066 [03:41<01:13,  3.71it/s] 75%|███████▍  | 795/1066 [03:41<01:13,  3.68it/s] 75%|███████▍  | 796/1066 [03:41<01:13,  3.66it/s] 75%|███████▍  | 797/1066 [03:42<01:15,  3.58it/s] 75%|███████▍  | 798/1066 [03:42<01:14,  3.62it/s] 75%|███████▍  | 799/1066 [03:42<01:15,  3.53it/s] 75%|███████▌  | 800/1066 [03:43<01:14,  3.58it/s] 75%|███████▌  | 801/1066 [03:43<01:14,  3.57it/s] 75%|███████▌  | 802/1066 [03:43<01:12,  3.62it/s] 75%|███████▌  | 803/1066 [03:43<01:12,  3.65it/s] 75%|███████▌  | 804/1066 [03:44<01:10,  3.74it/s] 76%|███████▌  | 805/1066 [03:44<01:09,  3.75it/s] 76%|███████▌  | 806/1066 [03:44<01:10,  3.71it/s] 76%|███████▌  | 807/1066 [03:44<01:09,  3.70it/s] 76%|███████▌  | 808/1066 [03:45<01:10,  3.67it/s] 76%|███████▌  | 809/1066 [03:45<01:09,  3.72it/s] 76%|███████▌  | 810/1066 [03:45<01:08,  3.73it/s] 76%|███████▌  | 811/1066 [03:46<01:11,  3.59it/s] 76%|███████▌  | 812/1066 [03:46<01:10,  3.61it/s] 76%|███████▋  | 813/1066 [03:46<01:11,  3.54it/s] 76%|███████▋  | 814/1066 [03:46<01:10,  3.58it/s] 76%|███████▋  | 815/1066 [03:47<01:10,  3.56it/s] 77%|███████▋  | 816/1066 [03:47<01:08,  3.65it/s] 77%|███████▋  | 817/1066 [03:47<01:07,  3.71it/s] 77%|███████▋  | 818/1066 [03:47<01:07,  3.66it/s] 77%|███████▋  | 819/1066 [03:48<01:08,  3.62it/s] 77%|███████▋  | 820/1066 [03:48<01:10,  3.51it/s] 77%|███████▋  | 821/1066 [03:48<01:07,  3.61it/s] 77%|███████▋  | 822/1066 [03:49<01:08,  3.56it/s] 77%|███████▋  | 823/1066 [03:49<01:08,  3.55it/s] 77%|███████▋  | 824/1066 [03:49<01:08,  3.56it/s] 77%|███████▋  | 825/1066 [03:49<01:09,  3.49it/s] 77%|███████▋  | 826/1066 [03:50<01:07,  3.55it/s] 78%|███████▊  | 827/1066 [03:50<01:07,  3.53it/s] 78%|███████▊  | 828/1066 [03:50<01:06,  3.59it/s] 78%|███████▊  | 829/1066 [03:51<01:03,  3.72it/s] 78%|███████▊  | 830/1066 [03:51<01:04,  3.64it/s] 78%|███████▊  | 831/1066 [03:51<01:04,  3.64it/s] 78%|███████▊  | 832/1066 [03:51<01:05,  3.57it/s] 78%|███████▊  | 833/1066 [03:52<01:04,  3.59it/s] 78%|███████▊  | 834/1066 [03:52<01:05,  3.56it/s] 78%|███████▊  | 835/1066 [03:52<01:05,  3.54it/s] 78%|███████▊  | 836/1066 [03:53<01:05,  3.52it/s] 79%|███████▊  | 837/1066 [03:53<01:04,  3.53it/s] 79%|███████▊  | 838/1066 [03:53<01:04,  3.55it/s] 79%|███████▊  | 839/1066 [03:53<01:04,  3.52it/s] 79%|███████▉  | 840/1066 [03:54<01:03,  3.58it/s] 79%|███████▉  | 841/1066 [03:54<01:02,  3.62it/s] 79%|███████▉  | 842/1066 [03:54<01:01,  3.67it/s] 79%|███████▉  | 843/1066 [03:54<00:59,  3.72it/s] 79%|███████▉  | 844/1066 [03:55<01:00,  3.64it/s] 79%|███████▉  | 845/1066 [03:55<01:00,  3.66it/s] 79%|███████▉  | 846/1066 [03:55<01:01,  3.59it/s] 79%|███████▉  | 847/1066 [03:56<01:00,  3.63it/s] 80%|███████▉  | 848/1066 [03:56<00:59,  3.64it/s] 80%|███████▉  | 849/1066 [03:56<01:00,  3.59it/s] 80%|███████▉  | 850/1066 [03:56<01:00,  3.59it/s] 80%|███████▉  | 851/1066 [03:57<01:01,  3.50it/s] 80%|███████▉  | 852/1066 [03:57<00:59,  3.58it/s] 80%|████████  | 853/1066 [03:57<00:58,  3.66it/s] 80%|████████  | 854/1066 [03:57<00:57,  3.68it/s] 80%|████████  | 855/1066 [03:58<00:57,  3.69it/s] 80%|████████  | 856/1066 [03:58<00:57,  3.67it/s] 80%|████████  | 857/1066 [03:58<00:56,  3.70it/s] 80%|████████  | 858/1066 [03:59<00:55,  3.73it/s] 81%|████████  | 859/1066 [03:59<00:56,  3.65it/s] 81%|████████  | 860/1066 [03:59<00:56,  3.65it/s] 81%|████████  | 861/1066 [03:59<00:57,  3.56it/s] 81%|████████  | 862/1066 [04:00<00:56,  3.58it/s] 81%|████████  | 863/1066 [04:00<00:57,  3.55it/s] 81%|████████  | 864/1066 [04:00<00:55,  3.61it/s] 81%|████████  | 865/1066 [04:01<00:57,  3.51it/s] 81%|████████  | 866/1066 [04:01<00:56,  3.56it/s] 81%|████████▏ | 867/1066 [04:01<00:55,  3.61it/s] 81%|████████▏ | 868/1066 [04:01<00:54,  3.60it/s] 82%|████████▏ | 869/1066 [04:02<00:53,  3.66it/s] 82%|████████▏ | 870/1066 [04:02<00:53,  3.68it/s] 82%|████████▏ | 871/1066 [04:02<00:54,  3.57it/s] 82%|████████▏ | 872/1066 [04:02<00:54,  3.56it/s] 82%|████████▏ | 873/1066 [04:03<00:55,  3.48it/s] 82%|████████▏ | 874/1066 [04:03<00:54,  3.55it/s] 82%|████████▏ | 875/1066 [04:03<00:53,  3.57it/s] 82%|████████▏ | 876/1066 [04:04<00:54,  3.50it/s] 82%|████████▏ | 877/1066 [04:04<00:53,  3.53it/s] 82%|████████▏ | 878/1066 [04:04<00:54,  3.47it/s] 82%|████████▏ | 879/1066 [04:04<00:53,  3.52it/s] 83%|████████▎ | 880/1066 [04:05<00:50,  3.65it/s] 83%|████████▎ | 881/1066 [04:05<00:51,  3.62it/s] 83%|████████▎ | 882/1066 [04:05<00:50,  3.65it/s] 83%|████████▎ | 883/1066 [04:06<00:51,  3.53it/s] 83%|████████▎ | 884/1066 [04:06<00:51,  3.54it/s] 83%|████████▎ | 885/1066 [04:06<00:52,  3.48it/s] 83%|████████▎ | 886/1066 [04:06<00:51,  3.47it/s] 83%|████████▎ | 887/1066 [04:07<00:50,  3.54it/s] 83%|████████▎ | 888/1066 [04:07<00:51,  3.47it/s] 83%|████████▎ | 889/1066 [04:07<00:50,  3.53it/s] 83%|████████▎ | 890/1066 [04:08<00:49,  3.55it/s] 84%|████████▎ | 891/1066 [04:08<00:49,  3.57it/s] 84%|████████▎ | 892/1066 [04:08<00:47,  3.70it/s] 84%|████████▍ | 893/1066 [04:08<00:47,  3.65it/s] 84%|████████▍ | 894/1066 [04:09<00:46,  3.71it/s] 84%|████████▍ | 895/1066 [04:09<00:45,  3.72it/s] 84%|████████▍ | 896/1066 [04:09<00:46,  3.62it/s] 84%|████████▍ | 897/1066 [04:09<00:47,  3.56it/s] 84%|████████▍ | 898/1066 [04:10<00:48,  3.45it/s] 84%|████████▍ | 899/1066 [04:10<00:48,  3.47it/s] 84%|████████▍ | 900/1066 [04:10<00:48,  3.45it/s] 85%|████████▍ | 901/1066 [04:11<00:47,  3.51it/s] 85%|████████▍ | 902/1066 [04:11<00:47,  3.47it/s] 85%|████████▍ | 903/1066 [04:11<00:45,  3.55it/s] 85%|████████▍ | 904/1066 [04:11<00:44,  3.62it/s] 85%|████████▍ | 905/1066 [04:12<00:44,  3.62it/s] 85%|████████▍ | 906/1066 [04:12<00:43,  3.70it/s] 85%|████████▌ | 907/1066 [04:12<00:43,  3.65it/s] 85%|████████▌ | 908/1066 [04:13<00:43,  3.64it/s] 85%|████████▌ | 909/1066 [04:13<00:43,  3.63it/s] 85%|████████▌ | 910/1066 [04:13<00:44,  3.49it/s] 85%|████████▌ | 911/1066 [04:13<00:44,  3.51it/s] 86%|████████▌ | 912/1066 [04:14<00:44,  3.43it/s] 86%|████████▌ | 913/1066 [04:14<00:44,  3.47it/s] 86%|████████▌ | 914/1066 [04:14<00:43,  3.47it/s] 86%|████████▌ | 915/1066 [04:15<00:43,  3.47it/s] 86%|████████▌ | 916/1066 [04:15<00:42,  3.56it/s] 86%|████████▌ | 917/1066 [04:15<00:41,  3.56it/s] 86%|████████▌ | 918/1066 [04:15<00:40,  3.62it/s] 86%|████████▌ | 919/1066 [04:16<00:39,  3.69it/s] 86%|████████▋ | 920/1066 [04:16<00:40,  3.60it/s] 86%|████████▋ | 921/1066 [04:16<00:40,  3.60it/s] 86%|████████▋ | 922/1066 [04:17<00:40,  3.52it/s] 87%|████████▋ | 923/1066 [04:17<00:41,  3.49it/s] 87%|████████▋ | 924/1066 [04:17<00:40,  3.53it/s] 87%|████████▋ | 925/1066 [04:17<00:41,  3.43it/s] 87%|████████▋ | 926/1066 [04:18<00:40,  3.48it/s] 87%|████████▋ | 927/1066 [04:18<00:40,  3.39it/s] 87%|████████▋ | 928/1066 [04:18<00:39,  3.52it/s] 87%|████████▋ | 929/1066 [04:19<00:37,  3.62it/s] 87%|████████▋ | 930/1066 [04:19<00:37,  3.61it/s] 87%|████████▋ | 931/1066 [04:19<00:37,  3.64it/s] 87%|████████▋ | 932/1066 [04:19<00:36,  3.63it/s] 88%|████████▊ | 933/1066 [04:20<00:36,  3.64it/s] 88%|████████▊ | 934/1066 [04:20<00:35,  3.73it/s] 88%|████████▊ | 935/1066 [04:20<00:36,  3.61it/s] 88%|████████▊ | 936/1066 [04:20<00:36,  3.57it/s] 88%|████████▊ | 937/1066 [04:21<00:36,  3.49it/s] 88%|████████▊ | 938/1066 [04:21<00:36,  3.49it/s] 88%|████████▊ | 939/1066 [04:21<00:36,  3.52it/s] 88%|████████▊ | 940/1066 [04:22<00:36,  3.45it/s] 88%|████████▊ | 941/1066 [04:22<00:35,  3.56it/s] 88%|████████▊ | 942/1066 [04:22<00:35,  3.52it/s] 88%|████████▊ | 943/1066 [04:22<00:34,  3.59it/s] 89%|████████▊ | 944/1066 [04:23<00:34,  3.57it/s] 89%|████████▊ | 945/1066 [04:23<00:33,  3.65it/s] 89%|████████▊ | 946/1066 [04:23<00:32,  3.66it/s] 89%|████████▉ | 947/1066 [04:24<00:33,  3.56it/s] 89%|████████▉ | 948/1066 [04:24<00:33,  3.54it/s] 89%|████████▉ | 949/1066 [04:24<00:33,  3.51it/s] 89%|████████▉ | 950/1066 [04:24<00:33,  3.50it/s] 89%|████████▉ | 951/1066 [04:25<00:33,  3.47it/s] 89%|████████▉ | 952/1066 [04:25<00:33,  3.40it/s] 89%|████████▉ | 953/1066 [04:25<00:32,  3.46it/s] 89%|████████▉ | 954/1066 [04:26<00:32,  3.46it/s] 90%|████████▉ | 955/1066 [04:26<00:32,  3.46it/s] 90%|████████▉ | 956/1066 [04:26<00:30,  3.55it/s] 90%|████████▉ | 957/1066 [04:26<00:30,  3.52it/s] 90%|████████▉ | 958/1066 [04:27<00:29,  3.61it/s] 90%|████████▉ | 959/1066 [04:27<00:30,  3.52it/s] 90%|█████████ | 960/1066 [04:27<00:30,  3.53it/s] 90%|█████████ | 961/1066 [04:28<00:29,  3.50it/s] 90%|█████████ | 962/1066 [04:28<00:30,  3.39it/s] 90%|█████████ | 963/1066 [04:28<00:30,  3.39it/s] 90%|█████████ | 964/1066 [04:28<00:30,  3.34it/s] 91%|█████████ | 965/1066 [04:29<00:29,  3.39it/s] 91%|█████████ | 966/1066 [04:29<00:30,  3.31it/s] 91%|█████████ | 967/1066 [04:29<00:29,  3.38it/s] 91%|█████████ | 968/1066 [04:30<00:28,  3.44it/s] 91%|█████████ | 969/1066 [04:30<00:28,  3.42it/s] 91%|█████████ | 970/1066 [04:30<00:27,  3.53it/s] 91%|█████████ | 971/1066 [04:31<00:27,  3.44it/s] 91%|█████████ | 972/1066 [04:31<00:27,  3.45it/s] 91%|█████████▏| 973/1066 [04:31<00:27,  3.35it/s] 91%|█████████▏| 974/1066 [04:31<00:27,  3.37it/s] 91%|█████████▏| 975/1066 [04:32<00:27,  3.33it/s] 92%|█████████▏| 976/1066 [04:32<00:27,  3.33it/s] 92%|█████████▏| 977/1066 [04:32<00:26,  3.36it/s] 92%|█████████▏| 978/1066 [04:33<00:26,  3.32it/s] 92%|█████████▏| 979/1066 [04:33<00:25,  3.35it/s] 92%|█████████▏| 980/1066 [04:33<00:25,  3.33it/s] 92%|█████████▏| 981/1066 [04:33<00:24,  3.44it/s] 92%|█████████▏| 982/1066 [04:34<00:24,  3.38it/s] 92%|█████████▏| 983/1066 [04:34<00:23,  3.46it/s] 92%|█████████▏| 984/1066 [04:34<00:23,  3.47it/s] 92%|█████████▏| 985/1066 [04:35<00:23,  3.42it/s] 92%|█████████▏| 986/1066 [04:35<00:23,  3.40it/s] 93%|█████████▎| 987/1066 [04:35<00:23,  3.32it/s] 93%|█████████▎| 988/1066 [04:36<00:23,  3.35it/s] 93%|█████████▎| 989/1066 [04:36<00:23,  3.25it/s] 93%|█████████▎| 990/1066 [04:36<00:23,  3.29it/s] 93%|█████████▎| 991/1066 [04:36<00:22,  3.32it/s] 93%|█████████▎| 992/1066 [04:37<00:22,  3.32it/s] 93%|█████████▎| 993/1066 [04:37<00:21,  3.40it/s] 93%|█████████▎| 994/1066 [04:37<00:21,  3.37it/s] 93%|█████████▎| 995/1066 [04:38<00:20,  3.45it/s] 93%|█████████▎| 996/1066 [04:38<00:20,  3.44it/s] 94%|█████████▎| 997/1066 [04:38<00:19,  3.50it/s] 94%|█████████▎| 998/1066 [04:38<00:19,  3.48it/s] 94%|█████████▎| 999/1066 [04:39<00:19,  3.38it/s] 94%|█████████▍| 1000/1066 [04:39<00:19,  3.34it/s] 94%|█████████▍| 1001/1066 [04:39<00:19,  3.27it/s] 94%|█████████▍| 1002/1066 [04:40<00:19,  3.28it/s] 94%|█████████▍| 1003/1066 [04:40<00:19,  3.31it/s] 94%|█████████▍| 1004/1066 [04:40<00:18,  3.35it/s] 94%|█████████▍| 1005/1066 [04:41<00:18,  3.39it/s] 94%|█████████▍| 1006/1066 [04:41<00:17,  3.38it/s] 94%|█████████▍| 1007/1066 [04:41<00:17,  3.41it/s] 95%|█████████▍| 1008/1066 [04:42<00:17,  3.37it/s] 95%|█████████▍| 1009/1066 [04:42<00:16,  3.41it/s] 95%|█████████▍| 1010/1066 [04:42<00:16,  3.46it/s] 95%|█████████▍| 1011/1066 [04:42<00:16,  3.42it/s] 95%|█████████▍| 1012/1066 [04:43<00:15,  3.41it/s] 95%|█████████▌| 1013/1066 [04:43<00:15,  3.34it/s] 95%|█████████▌| 1014/1066 [04:43<00:15,  3.37it/s] 95%|█████████▌| 1015/1066 [04:44<00:15,  3.29it/s] 95%|█████████▌| 1016/1066 [04:44<00:15,  3.32it/s] 95%|█████████▌| 1017/1066 [04:44<00:14,  3.31it/s] 95%|█████████▌| 1018/1066 [04:44<00:14,  3.35it/s] 96%|█████████▌| 1019/1066 [04:45<00:13,  3.42it/s] 96%|█████████▌| 1020/1066 [04:45<00:13,  3.38it/s] 96%|█████████▌| 1021/1066 [04:45<00:13,  3.43it/s] 96%|█████████▌| 1022/1066 [04:46<00:12,  3.42it/s] 96%|█████████▌| 1023/1066 [04:46<00:12,  3.46it/s] 96%|█████████▌| 1024/1066 [04:46<00:12,  3.49it/s] 96%|█████████▌| 1025/1066 [04:47<00:12,  3.40it/s] 96%|█████████▌| 1026/1066 [04:47<00:11,  3.41it/s] 96%|█████████▋| 1027/1066 [04:47<00:11,  3.35it/s] 96%|█████████▋| 1028/1066 [04:47<00:11,  3.37it/s] 97%|█████████▋| 1029/1066 [04:48<00:11,  3.32it/s] 97%|█████████▋| 1030/1066 [04:48<00:10,  3.42it/s] 97%|█████████▋| 1031/1066 [04:48<00:09,  3.53it/s] 97%|█████████▋| 1032/1066 [04:49<00:09,  3.50it/s] 97%|█████████▋| 1033/1066 [04:49<00:09,  3.53it/s] 97%|█████████▋| 1034/1066 [04:49<00:09,  3.55it/s] 97%|█████████▋| 1035/1066 [04:49<00:08,  3.48it/s] 97%|█████████▋| 1036/1066 [04:50<00:08,  3.48it/s] 97%|█████████▋| 1037/1066 [04:50<00:08,  3.40it/s] 97%|█████████▋| 1038/1066 [04:50<00:08,  3.40it/s] 97%|█████████▋| 1039/1066 [04:51<00:07,  3.41it/s] 98%|█████████▊| 1040/1066 [04:51<00:07,  3.33it/s] 98%|█████████▊| 1041/1066 [04:51<00:07,  3.37it/s] 98%|█████████▊| 1042/1066 [04:51<00:07,  3.35it/s] 98%|█████████▊| 1043/1066 [04:52<00:06,  3.41it/s] 98%|█████████▊| 1044/1066 [04:52<00:06,  3.47it/s] 98%|█████████▊| 1045/1066 [04:52<00:05,  3.51it/s] 98%|█████████▊| 1046/1066 [04:53<00:05,  3.49it/s] 98%|█████████▊| 1047/1066 [04:53<00:05,  3.48it/s] 98%|█████████▊| 1048/1066 [04:53<00:05,  3.51it/s] 98%|█████████▊| 1049/1066 [04:53<00:04,  3.52it/s] 98%|█████████▊| 1050/1066 [04:54<00:05,  3.14it/s] 99%|█████████▊| 1051/1066 [04:54<00:04,  3.23it/s] 99%|█████████▊| 1052/1066 [04:54<00:04,  3.27it/s] 99%|█████████▉| 1053/1066 [04:55<00:03,  3.30it/s] 99%|█████████▉| 1054/1066 [04:55<00:03,  3.34it/s] 99%|█████████▉| 1055/1066 [04:55<00:03,  3.39it/s] 99%|█████████▉| 1056/1066 [04:56<00:02,  3.46it/s] 99%|█████████▉| 1057/1066 [04:56<00:02,  3.49it/s] 99%|█████████▉| 1058/1066 [04:56<00:02,  3.56it/s] 99%|█████████▉| 1059/1066 [04:56<00:01,  3.55it/s] 99%|█████████▉| 1060/1066 [04:57<00:01,  3.59it/s]100%|█████████▉| 1061/1066 [04:57<00:01,  3.23it/s]100%|█████████▉| 1062/1066 [04:57<00:01,  3.36it/s]100%|█████████▉| 1063/1066 [04:58<00:00,  3.43it/s]100%|█████████▉| 1064/1066 [04:58<00:00,  3.41it/s]100%|█████████▉| 1065/1066 [04:58<00:00,  3.40it/s]100%|██████████| 1066/1066 [04:59<00:00,  3.41it/s]100%|██████████| 1066/1066 [04:59<00:00,  3.57it/s]
('meta-llama/Llama-2-7b-hf',) gets {'lm': 0.5, 'dcpmi': 0.5, 'pmi': 0.5}% on None
0.5 & 0.5 & 0.5
parameters
k 2048
lmbda 0.1
temp 5.0
06/10/2024 02:36:11 - WARNING - __main__ - Process rank: 0, device: cuda:0, n_gpu: 1distributed training: True, 16-bits training: False
/home/sg2323/miniconda3/envs/faiss/lib/python3.9/site-packages/datasets/load.py:2547: FutureWarning: 'use_auth_token' was deprecated in favor of 'token' in version 2.14.0 and will be removed in 3.0.0.
You can remove this warning by passing 'token=<use_auth_token>' instead.
  warnings.warn(
/home/sg2323/miniconda3/envs/faiss/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:09<00:09,  9.88s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:13<00:00,  6.00s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:13<00:00,  6.58s/it]
06/10/2024 02:38:02 - INFO - knnlm - Reading /share/rush/datastore/knn-prompt/meta-llama/Llama-2-7b-hf/index_llama_609687689_4096_0_160000000.indexed took 95.30128121376038 s
06/10/2024 02:39:29 - INFO - knnlm - Reading /share/rush/datastore/knn-prompt/meta-llama/Llama-2-7b-hf/index_llama_609687689_4096_160000000_320000000.indexed took 87.01631355285645 s
06/10/2024 02:40:50 - INFO - knnlm - Reading /share/rush/datastore/knn-prompt/meta-llama/Llama-2-7b-hf/index_llama_609687689_4096_320000000_480000000.indexed took 81.72185468673706 s
06/10/2024 02:41:50 - INFO - knnlm - Reading /share/rush/datastore/knn-prompt/meta-llama/Llama-2-7b-hf/index_llama_609687689_4096_480000000_609687689.indexed took 59.83427286148071 s
use knn_gpu
Traceback (most recent call last):
  File "/home/sg2323/research/knnlm-limits/eval_fuzzy.py", line 901, in <module>
    main()
  File "/home/sg2323/research/knnlm-limits/eval_fuzzy.py", line 452, in main
    knn_wrapper.break_into(model)
  File "/home/sg2323/research/knnlm-limits/knnlm.py", line 155, in break_into
    self.reconstruct_index, self.indices = self.setup_faiss()
  File "/home/sg2323/research/knnlm-limits/knnlm.py", line 108, in setup_faiss
    gpu_indices.append(faiss.index_cpu_to_gpu(gpu_resource, 1, cpu_index, co))
  File "/home/sg2323/miniconda3/envs/faiss/lib/python3.9/site-packages/faiss/swigfaiss_avx2.py", line 12142, in index_cpu_to_gpu
    return _swigfaiss_avx2.index_cpu_to_gpu(provider, device, index, options)
RuntimeError: Error in faiss::gpu::GpuIndex::GpuIndex(std::shared_ptr<faiss::gpu::GpuResources>, int, faiss::MetricType, float, faiss::gpu::GpuIndexConfig) at /home/circleci/miniconda/conda-bld/faiss-pkg_1681998300314/work/faiss/gpu/GpuIndex.cu:55: Error: 'config_.device < getNumDevices()' failed: Invalid GPU device 1
06/10/2024 02:42:26 - WARNING - __main__ - Process rank: 0, device: cuda:0, n_gpu: 1distributed training: True, 16-bits training: False
/home/sg2323/miniconda3/envs/faiss/lib/python3.9/site-packages/datasets/load.py:2547: FutureWarning: 'use_auth_token' was deprecated in favor of 'token' in version 2.14.0 and will be removed in 3.0.0.
You can remove this warning by passing 'token=<use_auth_token>' instead.
  warnings.warn(
/home/sg2323/miniconda3/envs/faiss/lib/python3.9/site-packages/datasets/load.py:1486: FutureWarning: The repository for yahoo_answers_topics contains custom code which must be executed to correctly load the dataset. You can inspect the repository content at https://hf.co/datasets/yahoo_answers_topics
You can avoid this message in future by passing the argument `trust_remote_code=True`.
Passing `trust_remote_code=True` will be mandatory to load this dataset from the next major release of `datasets`.
  warnings.warn(
/home/sg2323/miniconda3/envs/faiss/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:09<00:09,  9.97s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:13<00:00,  6.25s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:13<00:00,  6.81s/it]
06/10/2024 02:44:38 - INFO - knnlm - Reading /share/rush/datastore/knn-prompt/meta-llama/Llama-2-7b-hf/index_llama_609687689_4096_0_160000000.indexed took 112.6697154045105 s
06/10/2024 02:46:03 - INFO - knnlm - Reading /share/rush/datastore/knn-prompt/meta-llama/Llama-2-7b-hf/index_llama_609687689_4096_160000000_320000000.indexed took 84.9758563041687 s
06/10/2024 02:47:49 - INFO - knnlm - Reading /share/rush/datastore/knn-prompt/meta-llama/Llama-2-7b-hf/index_llama_609687689_4096_320000000_480000000.indexed took 106.42812514305115 s
06/10/2024 02:49:34 - INFO - knnlm - Reading /share/rush/datastore/knn-prompt/meta-llama/Llama-2-7b-hf/index_llama_609687689_4096_480000000_609687689.indexed took 105.0049180984497 s
use knn_gpu
Traceback (most recent call last):
  File "/home/sg2323/research/knnlm-limits/eval_fuzzy.py", line 901, in <module>
    main()
  File "/home/sg2323/research/knnlm-limits/eval_fuzzy.py", line 452, in main
    knn_wrapper.break_into(model)
  File "/home/sg2323/research/knnlm-limits/knnlm.py", line 155, in break_into
    self.reconstruct_index, self.indices = self.setup_faiss()
  File "/home/sg2323/research/knnlm-limits/knnlm.py", line 108, in setup_faiss
    gpu_indices.append(faiss.index_cpu_to_gpu(gpu_resource, 1, cpu_index, co))
  File "/home/sg2323/miniconda3/envs/faiss/lib/python3.9/site-packages/faiss/swigfaiss_avx2.py", line 12142, in index_cpu_to_gpu
    return _swigfaiss_avx2.index_cpu_to_gpu(provider, device, index, options)
RuntimeError: Error in faiss::gpu::GpuIndex::GpuIndex(std::shared_ptr<faiss::gpu::GpuResources>, int, faiss::MetricType, float, faiss::gpu::GpuIndexConfig) at /home/circleci/miniconda/conda-bld/faiss-pkg_1681998300314/work/faiss/gpu/GpuIndex.cu:55: Error: 'config_.device < getNumDevices()' failed: Invalid GPU device 1
06/10/2024 02:50:16 - WARNING - __main__ - Process rank: 0, device: cuda:0, n_gpu: 1distributed training: True, 16-bits training: False
/home/sg2323/miniconda3/envs/faiss/lib/python3.9/site-packages/datasets/load.py:2547: FutureWarning: 'use_auth_token' was deprecated in favor of 'token' in version 2.14.0 and will be removed in 3.0.0.
You can remove this warning by passing 'token=<use_auth_token>' instead.
  warnings.warn(
/home/sg2323/miniconda3/envs/faiss/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:09<00:09,  9.06s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:12<00:00,  5.71s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:12<00:00,  6.21s/it]
06/10/2024 02:51:37 - INFO - knnlm - Reading /share/rush/datastore/knn-prompt/meta-llama/Llama-2-7b-hf/index_llama_609687689_4096_0_160000000.indexed took 65.90417861938477 s
06/10/2024 02:52:03 - INFO - knnlm - Reading /share/rush/datastore/knn-prompt/meta-llama/Llama-2-7b-hf/index_llama_609687689_4096_160000000_320000000.indexed took 26.72476625442505 s
06/10/2024 02:53:22 - INFO - knnlm - Reading /share/rush/datastore/knn-prompt/meta-llama/Llama-2-7b-hf/index_llama_609687689_4096_320000000_480000000.indexed took 78.58166170120239 s
06/10/2024 02:54:20 - INFO - knnlm - Reading /share/rush/datastore/knn-prompt/meta-llama/Llama-2-7b-hf/index_llama_609687689_4096_480000000_609687689.indexed took 57.51740097999573 s
use knn_gpu
Traceback (most recent call last):
  File "/home/sg2323/research/knnlm-limits/eval_fuzzy.py", line 901, in <module>
    main()
  File "/home/sg2323/research/knnlm-limits/eval_fuzzy.py", line 452, in main
    knn_wrapper.break_into(model)
  File "/home/sg2323/research/knnlm-limits/knnlm.py", line 155, in break_into
    self.reconstruct_index, self.indices = self.setup_faiss()
  File "/home/sg2323/research/knnlm-limits/knnlm.py", line 108, in setup_faiss
    gpu_indices.append(faiss.index_cpu_to_gpu(gpu_resource, 1, cpu_index, co))
  File "/home/sg2323/miniconda3/envs/faiss/lib/python3.9/site-packages/faiss/swigfaiss_avx2.py", line 12142, in index_cpu_to_gpu
    return _swigfaiss_avx2.index_cpu_to_gpu(provider, device, index, options)
RuntimeError: Error in faiss::gpu::GpuIndex::GpuIndex(std::shared_ptr<faiss::gpu::GpuResources>, int, faiss::MetricType, float, faiss::gpu::GpuIndexConfig) at /home/circleci/miniconda/conda-bld/faiss-pkg_1681998300314/work/faiss/gpu/GpuIndex.cu:55: Error: 'config_.device < getNumDevices()' failed: Invalid GPU device 1
06/10/2024 02:54:47 - WARNING - __main__ - Process rank: 0, device: cuda:0, n_gpu: 1distributed training: True, 16-bits training: False
/home/sg2323/miniconda3/envs/faiss/lib/python3.9/site-packages/datasets/load.py:2547: FutureWarning: 'use_auth_token' was deprecated in favor of 'token' in version 2.14.0 and will be removed in 3.0.0.
You can remove this warning by passing 'token=<use_auth_token>' instead.
  warnings.warn(
/home/sg2323/miniconda3/envs/faiss/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:04<00:04,  4.68s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:06<00:00,  2.92s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:06<00:00,  3.19s/it]
06/10/2024 02:55:00 - INFO - knnlm - Reading /share/rush/datastore/knn-prompt/meta-llama/Llama-2-7b-hf/index_llama_609687689_4096_0_160000000.indexed took 6.558851480484009 s
06/10/2024 02:55:44 - INFO - knnlm - Reading /share/rush/datastore/knn-prompt/meta-llama/Llama-2-7b-hf/index_llama_609687689_4096_160000000_320000000.indexed took 43.43126320838928 s
06/10/2024 02:56:02 - INFO - knnlm - Reading /share/rush/datastore/knn-prompt/meta-llama/Llama-2-7b-hf/index_llama_609687689_4096_320000000_480000000.indexed took 18.133096933364868 s
06/10/2024 02:56:53 - INFO - knnlm - Reading /share/rush/datastore/knn-prompt/meta-llama/Llama-2-7b-hf/index_llama_609687689_4096_480000000_609687689.indexed took 51.08375525474548 s
use knn_gpu
Traceback (most recent call last):
  File "/home/sg2323/research/knnlm-limits/eval_fuzzy.py", line 901, in <module>
    main()
  File "/home/sg2323/research/knnlm-limits/eval_fuzzy.py", line 452, in main
    knn_wrapper.break_into(model)
  File "/home/sg2323/research/knnlm-limits/knnlm.py", line 155, in break_into
    self.reconstruct_index, self.indices = self.setup_faiss()
  File "/home/sg2323/research/knnlm-limits/knnlm.py", line 108, in setup_faiss
    gpu_indices.append(faiss.index_cpu_to_gpu(gpu_resource, 1, cpu_index, co))
  File "/home/sg2323/miniconda3/envs/faiss/lib/python3.9/site-packages/faiss/swigfaiss_avx2.py", line 12142, in index_cpu_to_gpu
    return _swigfaiss_avx2.index_cpu_to_gpu(provider, device, index, options)
RuntimeError: Error in faiss::gpu::GpuIndex::GpuIndex(std::shared_ptr<faiss::gpu::GpuResources>, int, faiss::MetricType, float, faiss::gpu::GpuIndexConfig) at /home/circleci/miniconda/conda-bld/faiss-pkg_1681998300314/work/faiss/gpu/GpuIndex.cu:55: Error: 'config_.device < getNumDevices()' failed: Invalid GPU device 1
06/10/2024 02:57:08 - WARNING - __main__ - Process rank: 0, device: cuda:0, n_gpu: 1distributed training: True, 16-bits training: False
/home/sg2323/miniconda3/envs/faiss/lib/python3.9/site-packages/datasets/load.py:2547: FutureWarning: 'use_auth_token' was deprecated in favor of 'token' in version 2.14.0 and will be removed in 3.0.0.
You can remove this warning by passing 'token=<use_auth_token>' instead.
  warnings.warn(
/home/sg2323/miniconda3/envs/faiss/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:08<00:08,  8.80s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:11<00:00,  5.47s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:11<00:00,  5.97s/it]
06/10/2024 02:58:43 - INFO - knnlm - Reading /share/rush/datastore/knn-prompt/meta-llama/Llama-2-7b-hf/index_llama_609687689_4096_0_160000000.indexed took 81.9657826423645 s
06/10/2024 02:59:46 - INFO - knnlm - Reading /share/rush/datastore/knn-prompt/meta-llama/Llama-2-7b-hf/index_llama_609687689_4096_160000000_320000000.indexed took 62.670204639434814 s
06/10/2024 03:01:24 - INFO - knnlm - Reading /share/rush/datastore/knn-prompt/meta-llama/Llama-2-7b-hf/index_llama_609687689_4096_320000000_480000000.indexed took 98.07772850990295 s
06/10/2024 03:03:03 - INFO - knnlm - Reading /share/rush/datastore/knn-prompt/meta-llama/Llama-2-7b-hf/index_llama_609687689_4096_480000000_609687689.indexed took 99.69642090797424 s
use knn_gpu
Traceback (most recent call last):
  File "/home/sg2323/research/knnlm-limits/eval_fuzzy.py", line 901, in <module>
    main()
  File "/home/sg2323/research/knnlm-limits/eval_fuzzy.py", line 452, in main
    knn_wrapper.break_into(model)
  File "/home/sg2323/research/knnlm-limits/knnlm.py", line 155, in break_into
    self.reconstruct_index, self.indices = self.setup_faiss()
  File "/home/sg2323/research/knnlm-limits/knnlm.py", line 108, in setup_faiss
    gpu_indices.append(faiss.index_cpu_to_gpu(gpu_resource, 1, cpu_index, co))
  File "/home/sg2323/miniconda3/envs/faiss/lib/python3.9/site-packages/faiss/swigfaiss_avx2.py", line 12142, in index_cpu_to_gpu
    return _swigfaiss_avx2.index_cpu_to_gpu(provider, device, index, options)
RuntimeError: Error in faiss::gpu::GpuIndex::GpuIndex(std::shared_ptr<faiss::gpu::GpuResources>, int, faiss::MetricType, float, faiss::gpu::GpuIndexConfig) at /home/circleci/miniconda/conda-bld/faiss-pkg_1681998300314/work/faiss/gpu/GpuIndex.cu:55: Error: 'config_.device < getNumDevices()' failed: Invalid GPU device 1
06/10/2024 03:03:23 - WARNING - __main__ - Process rank: 0, device: cuda:0, n_gpu: 1distributed training: True, 16-bits training: False
/home/sg2323/miniconda3/envs/faiss/lib/python3.9/site-packages/datasets/load.py:2547: FutureWarning: 'use_auth_token' was deprecated in favor of 'token' in version 2.14.0 and will be removed in 3.0.0.
You can remove this warning by passing 'token=<use_auth_token>' instead.
  warnings.warn(
/home/sg2323/miniconda3/envs/faiss/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:04<00:04,  4.77s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:06<00:00,  2.92s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:06<00:00,  3.20s/it]
06/10/2024 03:04:56 - INFO - knnlm - Reading /share/rush/datastore/knn-prompt/meta-llama/Llama-2-7b-hf/index_llama_609687689_4096_0_160000000.indexed took 85.65932154655457 s
06/10/2024 03:06:39 - INFO - knnlm - Reading /share/rush/datastore/knn-prompt/meta-llama/Llama-2-7b-hf/index_llama_609687689_4096_160000000_320000000.indexed took 103.42131495475769 s
06/10/2024 03:08:13 - INFO - knnlm - Reading /share/rush/datastore/knn-prompt/meta-llama/Llama-2-7b-hf/index_llama_609687689_4096_320000000_480000000.indexed took 93.76815032958984 s
06/10/2024 03:08:54 - INFO - knnlm - Reading /share/rush/datastore/knn-prompt/meta-llama/Llama-2-7b-hf/index_llama_609687689_4096_480000000_609687689.indexed took 40.884464263916016 s
use knn_gpu
Traceback (most recent call last):
  File "/home/sg2323/research/knnlm-limits/eval_fuzzy.py", line 901, in <module>
    main()
  File "/home/sg2323/research/knnlm-limits/eval_fuzzy.py", line 452, in main
    knn_wrapper.break_into(model)
  File "/home/sg2323/research/knnlm-limits/knnlm.py", line 155, in break_into
    self.reconstruct_index, self.indices = self.setup_faiss()
  File "/home/sg2323/research/knnlm-limits/knnlm.py", line 108, in setup_faiss
    gpu_indices.append(faiss.index_cpu_to_gpu(gpu_resource, 1, cpu_index, co))
  File "/home/sg2323/miniconda3/envs/faiss/lib/python3.9/site-packages/faiss/swigfaiss_avx2.py", line 12142, in index_cpu_to_gpu
    return _swigfaiss_avx2.index_cpu_to_gpu(provider, device, index, options)
RuntimeError: Error in faiss::gpu::GpuIndex::GpuIndex(std::shared_ptr<faiss::gpu::GpuResources>, int, faiss::MetricType, float, faiss::gpu::GpuIndexConfig) at /home/circleci/miniconda/conda-bld/faiss-pkg_1681998300314/work/faiss/gpu/GpuIndex.cu:55: Error: 'config_.device < getNumDevices()' failed: Invalid GPU device 1
06/10/2024 03:09:11 - WARNING - __main__ - Process rank: 0, device: cuda:0, n_gpu: 1distributed training: True, 16-bits training: False
/home/sg2323/miniconda3/envs/faiss/lib/python3.9/site-packages/datasets/load.py:2547: FutureWarning: 'use_auth_token' was deprecated in favor of 'token' in version 2.14.0 and will be removed in 3.0.0.
You can remove this warning by passing 'token=<use_auth_token>' instead.
  warnings.warn(
/home/sg2323/miniconda3/envs/faiss/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:04<00:04,  4.71s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:06<00:00,  2.89s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:06<00:00,  3.16s/it]
06/10/2024 03:09:24 - INFO - knnlm - Reading /share/rush/datastore/knn-prompt/meta-llama/Llama-2-7b-hf/index_llama_609687689_4096_0_160000000.indexed took 6.390571117401123 s
06/10/2024 03:09:30 - INFO - knnlm - Reading /share/rush/datastore/knn-prompt/meta-llama/Llama-2-7b-hf/index_llama_609687689_4096_160000000_320000000.indexed took 6.388395547866821 s
06/10/2024 03:09:37 - INFO - knnlm - Reading /share/rush/datastore/knn-prompt/meta-llama/Llama-2-7b-hf/index_llama_609687689_4096_320000000_480000000.indexed took 6.628533840179443 s
06/10/2024 03:09:43 - INFO - knnlm - Reading /share/rush/datastore/knn-prompt/meta-llama/Llama-2-7b-hf/index_llama_609687689_4096_480000000_609687689.indexed took 5.472016096115112 s
use knn_gpu
Traceback (most recent call last):
  File "/home/sg2323/research/knnlm-limits/eval_fuzzy.py", line 901, in <module>
    main()
  File "/home/sg2323/research/knnlm-limits/eval_fuzzy.py", line 452, in main
    knn_wrapper.break_into(model)
  File "/home/sg2323/research/knnlm-limits/knnlm.py", line 155, in break_into
    self.reconstruct_index, self.indices = self.setup_faiss()
  File "/home/sg2323/research/knnlm-limits/knnlm.py", line 108, in setup_faiss
    gpu_indices.append(faiss.index_cpu_to_gpu(gpu_resource, 1, cpu_index, co))
  File "/home/sg2323/miniconda3/envs/faiss/lib/python3.9/site-packages/faiss/swigfaiss_avx2.py", line 12142, in index_cpu_to_gpu
    return _swigfaiss_avx2.index_cpu_to_gpu(provider, device, index, options)
RuntimeError: Error in faiss::gpu::GpuIndex::GpuIndex(std::shared_ptr<faiss::gpu::GpuResources>, int, faiss::MetricType, float, faiss::gpu::GpuIndexConfig) at /home/circleci/miniconda/conda-bld/faiss-pkg_1681998300314/work/faiss/gpu/GpuIndex.cu:55: Error: 'config_.device < getNumDevices()' failed: Invalid GPU device 1
