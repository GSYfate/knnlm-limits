06/11/2024 02:24:20 - WARNING - __main__ - Process rank: 0, device: cpu, n_gpu: 1distributed training: True, 16-bits training: False
val dataset length is
146730
/home/sg2323/miniconda3/envs/faiss/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(

Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]
Loading checkpoint shards:  33%|███▎      | 1/3 [00:06<00:13,  7.00s/it]
Loading checkpoint shards:  67%|██████▋   | 2/3 [00:14<00:07,  7.19s/it]
Loading checkpoint shards: 100%|██████████| 3/3 [00:20<00:00,  6.88s/it]
Loading checkpoint shards: 100%|██████████| 3/3 [00:20<00:00,  6.94s/it]
device: cpu
1
text_column_name is text
06/11/2024 02:24:50 - WARNING - __main__ - The tokenizer picked seems to have a very large `model_max_length` (1000000000000000019884624838656). Picking 1024 instead. You can change that default value by passing --block_size xxx.
06/11/2024 02:32:08 - WARNING - accelerate.utils.other - Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
06/11/2024 02:32:08 - INFO - knnlm3 - keytype being saved: KEY_TYPE.last_ffn_input
06/11/2024 02:32:08 - INFO - knnlm3 - Saving fp16
call get_model_last_layer
06/11/2024 02:32:08 - INFO - knnlm3 - Building index
06/11/2024 02:32:09 - INFO - knnlm3 - Adding Keys
06/11/2024 02:32:09 - INFO - knnlm3 - Adding Index 0
/home/sg2323/miniconda3/envs/faiss/lib/python3.9/site-packages/faiss/contrib/torch_utils.py:51: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  x.storage().data_ptr() + x.storage_offset() * 4)
06/11/2024 03:01:57 - INFO - knnlm3 - Writing Index 0
06/11/2024 03:01:57 - INFO - knnlm3 - Adding Index 100000006/11/2024 03:33:58 - INFO - knnlm3 - Writing Index 1000000
06/11/2024 03:33:59 - INFO - knnlm3 - Adding Index 2000000
06/11/2024 03:59:48 - INFO - knnlm3 - Writing Index 2000000
06/11/2024 03:59:49 - INFO - knnlm3 - Adding Index 3000000
06/11/2024 04:40:16 - INFO - knnlm3 - Writing Index 3000000
06/11/2024 04:40:17 - INFO - knnlm3 - Adding Index 4000000
06/11/2024 05:14:16 - INFO - knnlm3 - Writing Index 4000000
06/11/2024 05:14:17 - INFO - knnlm3 - Adding Index 5000000
06/11/2024 05:57:35 - INFO - knnlm3 - Writing Index 5000000
06/11/2024 05:57:36 - INFO - knnlm3 - Adding Index 6000000
06/11/2024 06:46:55 - INFO - knnlm3 - Writing Index 6000000
06/11/2024 06:46:56 - INFO - knnlm3 - Adding Index 7000000
06/11/2024 07:35:36 - INFO - knnlm3 - Writing Index 7000000
06/11/2024 07:35:37 - INFO - knnlm3 - Adding Index 8000000
06/11/2024 08:28:39 - INFO - knnlm3 - Writing Index 8000000
06/11/2024 08:28:40 - INFO - knnlm3 - Adding Index 9000000
06/11/2024 09:15:37 - INFO - knnlm3 - Writing Index 9000000
06/11/2024 09:15:39 - INFO - knnlm3 - Adding Index 10000000
06/11/2024 10:04:56 - INFO - knnlm3 - Writing Index 10000000
06/11/2024 10:04:58 - INFO - knnlm3 - Adding Index 11000000
06/11/2024 10:57:04 - INFO - knnlm3 - Writing Index 11000000
06/11/2024 10:57:05 - INFO - knnlm3 - Adding Index 12000000
06/11/2024 11:54:38 - INFO - knnlm3 - Writing Index 12000000
06/11/2024 11:54:39 - INFO - knnlm3 - Adding Index 13000000
06/11/2024 12:32:34 - INFO - knnlm3 - Writing Index 13000000
06/11/2024 12:32:36 - INFO - knnlm3 - Adding Index 14000000
06/11/2024 13:14:20 - INFO - knnlm3 - Writing Index 14000000
06/11/2024 13:14:22 - INFO - knnlm3 - Adding Index 15000000
06/11/2024 14:01:17 - INFO - knnlm3 - Writing Index 15000000
06/11/2024 14:01:19 - INFO - knnlm3 - Adding Index 16000000
06/11/2024 14:41:36 - INFO - knnlm3 - Writing Index 16000000
06/11/2024 14:41:38 - INFO - knnlm3 - Adding Index 17000000
06/11/2024 15:14:37 - INFO - knnlm3 - Writing Index 17000000
06/11/2024 15:14:39 - INFO - knnlm3 - Adding Index 18000000
06/11/2024 15:47:17 - INFO - knnlm3 - Writing Index 18000000
06/11/2024 15:47:19 - INFO - knnlm3 - Adding Index 19000000
06/11/2024 16:25:30 - INFO - knnlm3 - Writing Index 19000000
06/11/2024 16:25:34 - INFO - knnlm3 - Adding Index 20000000
06/11/2024 17:11:09 - INFO - knnlm3 - Writing Index 20000000
06/11/2024 17:11:11 - INFO - knnlm3 - Adding Index 21000000
06/11/2024 17:52:27 - INFO - knnlm3 - Writing Index 21000000
06/11/2024 17:52:29 - INFO - knnlm3 - Adding Index 22000000
06/11/2024 18:38:02 - INFO - knnlm3 - Writing Index 22000000
06/11/2024 18:38:05 - INFO - knnlm3 - Adding Index 23000000
06/11/2024 19:26:12 - INFO - knnlm3 - Writing Index 23000000
06/11/2024 19:26:14 - INFO - knnlm3 - Adding Index 24000000
06/11/2024 20:20:43 - INFO - knnlm3 - Writing Index 24000000
06/11/2024 20:20:46 - INFO - knnlm3 - Adding Index 25000000
06/11/2024 21:07:42 - INFO - knnlm3 - Writing Index 25000000
06/11/2024 21:07:45 - INFO - knnlm3 - Adding Index 26000000
06/11/2024 21:59:07 - INFO - knnlm3 - Writing Index 26000000
06/11/2024 21:59:10 - INFO - knnlm3 - Adding Index 27000000
06/11/2024 22:52:11 - INFO - knnlm3 - Writing Index 27000000
06/11/2024 22:52:16 - INFO - knnlm3 - Adding Index 28000000
06/11/2024 23:41:01 - INFO - knnlm3 - Writing Index 28000000
06/11/2024 23:41:04 - INFO - knnlm3 - Adding Index 29000000
06/12/2024 00:35:19 - INFO - knnlm3 - Writing Index 29000000
06/12/2024 00:35:22 - INFO - knnlm3 - Adding Index 30000000
06/12/2024 01:22:00 - INFO - knnlm3 - Writing Index 30000000
06/12/2024 01:22:04 - INFO - knnlm3 - Adding Index 31000000
06/12/2024 02:11:11 - INFO - knnlm3 - Writing Index 31000000
06/12/2024 02:11:15 - INFO - knnlm3 - Adding Index 32000000
06/12/2024 03:00:39 - INFO - knnlm3 - Writing Index 32000000
06/12/2024 03:00:42 - INFO - knnlm3 - Adding Index 33000000
06/12/2024 03:49:50 - INFO - knnlm3 - Writing Index 33000000
06/12/2024 03:49:55 - INFO - knnlm3 - Adding Index 34000000
06/12/2024 04:46:21 - INFO - knnlm3 - Writing Index 34000000
06/12/2024 04:46:25 - INFO - knnlm3 - Adding Index 35000000
06/12/2024 05:39:10 - INFO - knnlm3 - Writing Index 35000000
06/12/2024 05:39:15 - INFO - knnlm3 - Adding Index 36000000
06/12/2024 06:23:41 - INFO - knnlm3 - Writing Index 36000000
06/12/2024 06:23:45 - INFO - knnlm3 - Adding Index 37000000
06/12/2024 07:30:46 - INFO - knnlm3 - Writing Index 37000000
06/12/2024 07:30:50 - INFO - knnlm3 - Adding Index 38000000
06/12/2024 08:26:24 - INFO - knnlm3 - Writing Index 38000000
06/12/2024 08:26:29 - INFO - knnlm3 - Adding Index 39000000
06/12/2024 09:17:04 - INFO - knnlm3 - Writing Index 39000000
06/12/2024 09:17:08 - INFO - knnlm3 - Adding Index 40000000
06/12/2024 10:25:01 - INFO - knnlm3 - Writing Index 40000000
06/12/2024 10:25:05 - INFO - knnlm3 - Adding Index 41000000
06/12/2024 11:20:11 - INFO - knnlm3 - Writing Index 41000000
06/12/2024 11:20:16 - INFO - knnlm3 - Adding Index 42000000
06/12/2024 12:10:18 - INFO - knnlm3 - Writing Index 42000000
06/12/2024 12:10:22 - INFO - knnlm3 - Adding Index 43000000
06/12/2024 12:53:46 - INFO - knnlm3 - Writing Index 43000000
06/12/2024 12:53:51 - INFO - knnlm3 - Adding Index 44000000
06/12/2024 13:36:43 - INFO - knnlm3 - Writing Index 44000000
06/12/2024 13:36:49 - INFO - knnlm3 - Adding Index 45000000
06/12/2024 14:27:12 - INFO - knnlm3 - Writing Index 45000000
06/12/2024 14:27:17 - INFO - knnlm3 - Adding Index 46000000
06/12/2024 15:15:54 - INFO - knnlm3 - Writing Index 46000000
06/12/2024 15:15:59 - INFO - knnlm3 - Adding Index 47000000
06/12/2024 16:05:35 - INFO - knnlm3 - Writing Index 47000000
06/12/2024 16:05:40 - INFO - knnlm3 - Adding Index 48000000
06/12/2024 16:56:44 - INFO - knnlm3 - Writing Index 48000000
06/12/2024 16:56:50 - INFO - knnlm3 - Adding Index 49000000
06/12/2024 17:43:34 - INFO - knnlm3 - Writing Index 49000000
06/12/2024 17:43:40 - INFO - knnlm3 - Adding Index 50000000
06/12/2024 18:34:19 - INFO - knnlm3 - Writing Index 50000000
06/12/2024 18:34:24 - INFO - knnlm3 - Adding Index 51000000
06/12/2024 19:18:43 - INFO - knnlm3 - Writing Index 51000000
06/12/2024 19:18:49 - INFO - knnlm3 - Adding Index 52000000
06/12/2024 19:59:17 - INFO - knnlm3 - Writing Index 52000000
06/12/2024 19:59:23 - INFO - knnlm3 - Adding Index 53000000
06/12/2024 20:40:25 - INFO - knnlm3 - Writing Index 53000000
06/12/2024 20:40:31 - INFO - knnlm3 - Adding Index 54000000
06/12/2024 21:18:14 - INFO - knnlm3 - Writing Index 54000000
06/12/2024 21:18:20 - INFO - knnlm3 - Adding Index 55000000
06/12/2024 21:59:38 - INFO - knnlm3 - Writing Index 55000000
06/12/2024 21:59:45 - INFO - knnlm3 - Adding Index 56000000
06/12/2024 22:42:33 - INFO - knnlm3 - Writing Index 56000000
06/12/2024 22:42:40 - INFO - knnlm3 - Adding Index 57000000
06/12/2024 23:31:47 - INFO - knnlm3 - Writing Index 57000000
06/12/2024 23:31:53 - INFO - knnlm3 - Adding Index 58000000
06/13/2024 00:03:02 - INFO - knnlm3 - Writing Index 58000000
06/13/2024 00:03:08 - INFO - knnlm3 - Adding Index 59000000
06/13/2024 00:31:59 - INFO - knnlm3 - Writing Index 59000000
06/13/2024 00:32:06 - INFO - knnlm3 - Adding Index 60000000
06/13/2024 01:07:01 - INFO - knnlm3 - Writing Index 60000000
06/13/2024 01:07:08 - INFO - knnlm3 - Adding Index 61000000
06/13/2024 01:41:59 - INFO - knnlm3 - Writing Index 61000000
06/13/2024 01:42:06 - INFO - knnlm3 - Adding Index 62000000
06/13/2024 02:10:30 - INFO - knnlm3 - Writing Index 62000000
06/13/2024 02:10:37 - INFO - knnlm3 - Adding Index 63000000
06/13/2024 02:45:32 - INFO - knnlm3 - Writing Index 63000000
06/13/2024 02:45:39 - INFO - knnlm3 - Adding Index 64000000
06/13/2024 03:21:23 - INFO - knnlm3 - Writing Index 64000000
06/13/2024 03:21:30 - INFO - knnlm3 - Adding Index 65000000
06/13/2024 03:50:08 - INFO - knnlm3 - Writing Index 65000000
06/13/2024 03:50:16 - INFO - knnlm3 - Adding Index 66000000
06/13/2024 04:22:54 - INFO - knnlm3 - Writing Index 66000000
06/13/2024 04:23:02 - INFO - knnlm3 - Adding Index 67000000
06/13/2024 05:01:03 - INFO - knnlm3 - Writing Index 67000000
06/13/2024 05:01:11 - INFO - knnlm3 - Adding Index 68000000
06/13/2024 05:32:39 - INFO - knnlm3 - Writing Index 68000000
06/13/2024 05:32:47 - INFO - knnlm3 - Adding Index 69000000
06/13/2024 06:02:24 - INFO - knnlm3 - Writing Index 69000000
06/13/2024 06:02:32 - INFO - knnlm3 - Adding Index 70000000
06/13/2024 06:39:50 - INFO - knnlm3 - Writing Index 70000000
06/13/2024 06:39:58 - INFO - knnlm3 - Adding Index 71000000
06/13/2024 07:19:59 - INFO - knnlm3 - Writing Index 71000000
06/13/2024 07:20:07 - INFO - knnlm3 - Adding Index 72000000
06/13/2024 07:53:36 - INFO - knnlm3 - Writing Index 72000000
06/13/2024 07:53:44 - INFO - knnlm3 - Adding Index 73000000
06/13/2024 08:23:51 - INFO - knnlm3 - Writing Index 73000000
06/13/2024 08:24:00 - INFO - knnlm3 - Adding Index 74000000
06/13/2024 09:00:24 - INFO - knnlm3 - Writing Index 74000000
06/13/2024 09:00:33 - INFO - knnlm3 - Adding Index 75000000
06/13/2024 09:39:59 - INFO - knnlm3 - Writing Index 75000000
06/13/2024 09:40:08 - INFO - knnlm3 - Adding Index 76000000
