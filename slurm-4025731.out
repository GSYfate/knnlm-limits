06/10/2024 16:02:49 - WARNING - __main__ - Process rank: 0, device: cpu, n_gpu: 1distributed training: True, 16-bits training: False
val dataset length is
146730
/home/sg2323/miniconda3/envs/faiss/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
[WARNING|logging.py:314] 2024-06-10 16:03:12,282 >> Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:43<02:09, 43.05s/it]Loading checkpoint shards:  50%|█████     | 2/4 [01:26<01:26, 43.40s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [02:16<00:46, 46.13s/it]Loading checkpoint shards: 100%|██████████| 4/4 [02:26<00:00, 31.94s/it]Loading checkpoint shards: 100%|██████████| 4/4 [02:26<00:00, 36.57s/it]
device: cpu
1
text_column_name is text
06/10/2024 16:05:54 - WARNING - __main__ - The tokenizer picked seems to have a very large `model_max_length` (1000000000000000019884624838656). Picking 1024 instead. You can change that default value by passing --block_size xxx.
06/10/2024 16:16:12 - WARNING - accelerate.utils.other - Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
06/10/2024 16:16:12 - INFO - knnlm2 - keytype being saved: KEY_TYPE.last_ffn_input
06/10/2024 16:16:12 - INFO - knnlm2 - Saving fp16
call get_model_last_layer
06/10/2024 16:16:12 - INFO - knnlm2 - Building index
06/10/2024 16:16:14 - INFO - knnlm2 - Adding Keys
06/10/2024 16:16:14 - INFO - knnlm2 - Adding Index 0
/home/sg2323/miniconda3/envs/faiss/lib/python3.9/site-packages/faiss/contrib/torch_utils.py:51: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  x.storage().data_ptr() + x.storage_offset() * 4)
06/10/2024 16:27:43 - INFO - knnlm2 - Writing Index 0
06/10/2024 16:27:45 - INFO - knnlm2 - Adding Index 1000000
06/10/2024 16:38:39 - INFO - knnlm2 - Writing Index 1000000
06/10/2024 16:38:41 - INFO - knnlm2 - Adding Index 2000000
06/10/2024 16:49:52 - INFO - knnlm2 - Writing Index 2000000
06/10/2024 16:49:55 - INFO - knnlm2 - Adding Index 3000000
06/10/2024 17:00:38 - INFO - knnlm2 - Writing Index 3000000
06/10/2024 17:00:41 - INFO - knnlm2 - Adding Index 4000000
06/10/2024 17:11:31 - INFO - knnlm2 - Writing Index 4000000
06/10/2024 17:11:35 - INFO - knnlm2 - Adding Index 5000000
06/10/2024 17:22:26 - INFO - knnlm2 - Writing Index 5000000
06/10/2024 17:22:31 - INFO - knnlm2 - Adding Index 6000000
06/10/2024 17:33:19 - INFO - knnlm2 - Writing Index 6000000
06/10/2024 17:33:24 - INFO - knnlm2 - Adding Index 7000000
06/10/2024 17:44:12 - INFO - knnlm2 - Writing Index 7000000
06/10/2024 17:44:18 - INFO - knnlm2 - Adding Index 8000000
06/10/2024 17:55:29 - INFO - knnlm2 - Writing Index 8000000
06/10/2024 17:55:36 - INFO - knnlm2 - Adding Index 9000000
06/10/2024 18:06:55 - INFO - knnlm2 - Writing Index 9000000
06/10/2024 18:07:03 - INFO - knnlm2 - Adding Index 10000000
06/10/2024 18:18:21 - INFO - knnlm2 - Writing Index 10000000
06/10/2024 18:18:29 - INFO - knnlm2 - Adding Index 11000000
06/10/2024 18:29:49 - INFO - knnlm2 - Writing Index 11000000
06/10/2024 18:29:57 - INFO - knnlm2 - Adding Index 12000000
06/10/2024 18:41:21 - INFO - knnlm2 - Writing Index 12000000
06/10/2024 18:41:31 - INFO - knnlm2 - Adding Index 13000000
06/10/2024 18:52:49 - INFO - knnlm2 - Writing Index 13000000
06/10/2024 18:52:59 - INFO - knnlm2 - Adding Index 14000000
06/10/2024 19:04:18 - INFO - knnlm2 - Writing Index 14000000
06/10/2024 19:04:29 - INFO - knnlm2 - Adding Index 15000000
06/10/2024 19:15:52 - INFO - knnlm2 - Writing Index 15000000
06/10/2024 19:16:04 - INFO - knnlm2 - Adding Index 16000000
06/10/2024 19:27:26 - INFO - knnlm2 - Writing Index 16000000
06/10/2024 19:27:38 - INFO - knnlm2 - Adding Index 17000000
06/10/2024 19:38:29 - INFO - knnlm2 - Writing Index 17000000
06/10/2024 19:38:42 - INFO - knnlm2 - Adding Index 18000000
06/10/2024 19:49:34 - INFO - knnlm2 - Writing Index 18000000
06/10/2024 19:49:48 - INFO - knnlm2 - Adding Index 19000000
06/10/2024 20:00:38 - INFO - knnlm2 - Writing Index 19000000
06/10/2024 20:00:52 - INFO - knnlm2 - Adding Index 20000000
06/10/2024 20:11:43 - INFO - knnlm2 - Writing Index 20000000
06/10/2024 20:11:58 - INFO - knnlm2 - Adding Index 21000000
06/10/2024 20:22:47 - INFO - knnlm2 - Writing Index 21000000
06/10/2024 20:23:03 - INFO - knnlm2 - Adding Index 22000000
06/10/2024 20:33:53 - INFO - knnlm2 - Writing Index 22000000
06/10/2024 20:34:09 - INFO - knnlm2 - Adding Index 23000000
06/10/2024 20:42:36 - INFO - knnlm2 - Writing Index 23000000
Writing index took 15998.38767337799 s
current ntotal: 23781660
